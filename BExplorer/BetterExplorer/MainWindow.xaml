<Ribbon:RibbonWindow
  x:Class="BetterExplorer.MainWindow"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:Controls="clr-namespace:wyDay.Controls;assembly=AutomaticUpdaterWPF"
  xmlns:Helper="clr-namespace:BEHelper;assembly=BEHelper"
  xmlns:Microsoft_Windows_Themes="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Aero"
  xmlns:Previewer="clr-namespace:WpfDocumentPreviewer;assembly=WpfDocumentPreviewer"
  xmlns:Ribbon="clr-namespace:Fluent;assembly=Fluent"
  xmlns:borders="clr-namespace:ToggleSwitch.Borders;assembly=ToggleSwitch"
  xmlns:console="clr-namespace:ConsoleControl;assembly=ConsoleControl"
  xmlns:controls="clr-namespace:BetterExplorerControls;assembly=BetterExplorerControls"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:local="clr-namespace:BetterExplorer"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:my2="http://schemas.microsoft.com/winfx/2006/xaml/presentation/ribbon"
  xmlns:ni="http://www.hardcodet.net/taskbar"
  xmlns:odc="clr-namespace:Odyssey.Controls;assembly=Odyssey"
  xmlns:shell="clr-namespace:BExplorer.Shell;assembly=BExplorerShell"
  xmlns:tabcontrol="clr-namespace:Wpf.Controls;assembly=Wpf.TabControl"
  xmlns:toggleswitch="clr-namespace:ToggleSwitch;assembly=ToggleSwitch"
  xmlns:toolkit="http://schemas.xceed.com/wpf/xaml/toolkit"
  xmlns:utils="clr-namespace:ToggleSwitch.Utils;assembly=ToggleSwitch"
  Title="Better Explorer"
  MinWidth="640"
  MinHeight="480"
  d:DesignHeight="768"
  d:DesignWidth="852"
  Activated="RibbonWindow_Activated"
  Closing="RibbonWindow_Closing"
  Closed="MainWindow_OnClosed"
  Icon="Explorer.ico"
  Initialized="RibbonWindow_Initialized"
  Loaded="Window_Loaded"
  PreviewKeyDown="RibbonWindow_PreviewKeyDown"
  ResizeMode="CanResizeWithGrip"
  SizeChanged="RibbonWindow_SizeChanged"
  StateChanged="RibbonWindow_StateChanged"
  TextOptions.TextFormattingMode="Display"
  WindowState="Maximized"
  mc:Ignorable="d">

  <Ribbon:RibbonWindow.Resources>
    <ResourceDictionary>
      <Geometry x:Key="arrow">F1 M 724.371,610.402C 724.402,610.356 724.431,610.312 724.459,610.263C 724.488,610.211 724.511,610.159 724.595,609.975C 724.619,609.919 724.634,609.862 724.652,609.803C 724.666,609.756 724.68,609.71 724.691,609.662C 724.704,609.606 724.712,609.548 724.72,609.492C 724.728,609.443 724.732,609.395 724.738,609.347C 724.743,609.288 724.743,609.23 724.74,609.171C 724.74,609.124 724.743,609.078 724.738,609.031C 724.735,608.97 724.726,608.91 724.718,608.85C 724.71,608.804 724.704,608.76 724.694,608.714C 724.68,608.655 724.663,608.596 724.644,608.539C 724.631,608.492 724.619,608.448 724.53,608.24C 724.507,608.196 724.486,608.152 724.462,608.108C 724.434,608.056 724.399,608.006 724.286,607.842C 724.246,607.792 724.204,607.746 724.103,607.632L 713.832,597.36C 712.972,596.502 711.584,596.502 710.728,597.36C 709.871,598.215 709.871,599.606 710.728,600.462L 717.256,606.988L 696.934,606.988C 696.176,606.988 695.507,607.372 695.114,607.956C 694.876,608.307 694.738,608.728 694.738,609.184C 694.738,609.79 694.983,610.338 695.382,610.735C 695.778,611.134 696.327,611.378 696.934,611.378L 717.256,611.378L 710.728,617.904C 709.871,618.762 709.871,620.151 710.728,621.007C 711.158,621.436 711.718,621.652 712.28,621.652C 712.843,621.652 713.402,621.438 713.832,621.01L 724.166,610.666C 724.204,610.622 724.246,610.576 724.283,610.528C 724.314,610.487 724.343,610.444 724.371,610.402 Z</Geometry>
      <Geometry x:Key="arrowCircle">F1 M 711.074,631.265C 698.899,631.265 688.993,621.358 688.993,609.185C 688.993,597.012 698.899,587.106 711.074,587.106C 723.246,587.106 733.153,597.012 733.153,609.185C 733.153,621.358 723.246,631.265 711.074,631.265 Z M 711.072,583.325C 696.79,583.325 685.213,594.901 685.213,609.184C 685.213,623.465 696.79,635.044 711.072,635.044C 725.353,635.044 736.932,623.465 736.932,609.184C 736.932,594.901 725.353,583.325 711.072,583.325 Z</Geometry>
      <DataTemplate DataType="{x:Type shell:ShellItem}">
        <TextBlock Text="{Binding DisplayName}" />
      </DataTemplate>
      <ControlTemplate x:Key="SafariThumbControlTemplate" TargetType="Thumb">
        <Grid Background="Transparent">
          <borders:OuterGlowBorder
            Background="Transparent"
            BorderThickness="0"
            CornerRadius="2"
            IsTabStop="False"
            OuterGlowColor="Black"
            OuterGlowOpacity="0.15"
            OuterGlowSize="4"
            ShadowCornerRadius="4">
            <Grid>
              <borders:ClippingBorder
                x:Name="Background"
                Background="{TemplateBinding Background}"
                BorderBrush="#FF656565"
                BorderThickness="{TemplateBinding BorderThickness}"
                CornerRadius="2"
                IsTabStop="False" />
              <borders:ClippingBorder
                x:Name="BackgroundAnimation"
                Background="Black"
                BorderBrush="Black"
                BorderThickness="{TemplateBinding BorderThickness}"
                CornerRadius="2"
                IsTabStop="False"
                Opacity="0" />
              <Rectangle
                x:Name="DisabledVisualElement"
                Fill="White"
                IsHitTestVisible="false"
                Opacity="0"
                RadiusX="2"
                RadiusY="2" />
              <Rectangle
                x:Name="FocusVisualElement"
                Margin="1"
                IsHitTestVisible="false"
                Opacity="0"
                RadiusX="2"
                RadiusY="2"
                StrokeThickness="1" />
            </Grid>
          </borders:OuterGlowBorder>
          <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="CommonStates">
              <VisualState x:Name="Normal" />
              <VisualState x:Name="MouseOver">
                <Storyboard>
                  <DoubleAnimation
                    Storyboard.TargetName="BackgroundAnimation"
                    Storyboard.TargetProperty="Opacity"
                    To="0.05"
                    Duration="0" />
                </Storyboard>
              </VisualState>
              <VisualState x:Name="Pressed">
                <Storyboard>
                  <DoubleAnimation
                    Storyboard.TargetName="BackgroundAnimation"
                    Storyboard.TargetProperty="Opacity"
                    To="0.25"
                    Duration="0" />
                </Storyboard>
              </VisualState>
              <VisualState x:Name="Disabled">
                <Storyboard>
                  <DoubleAnimation
                    Storyboard.TargetName="DisabledVisualElement"
                    Storyboard.TargetProperty="Opacity"
                    To=".55"
                    Duration="0" />
                </Storyboard>
              </VisualState>
            </VisualStateGroup>
            <VisualStateGroup x:Name="FocusStates">
              <VisualState x:Name="Focused">
                <Storyboard>
                  <DoubleAnimation
                    Storyboard.TargetName="FocusVisualElement"
                    Storyboard.TargetProperty="Opacity"
                    To="0.05"
                    Duration="0" />
                </Storyboard>
              </VisualState>
              <VisualState x:Name="Unfocused" />
            </VisualStateGroup>
            <VisualStateGroup x:Name="CheckStates">
              <VisualState x:Name="Unchecked" />
              <VisualState x:Name="Checked" />
            </VisualStateGroup>
          </VisualStateManager.VisualStateGroups>
        </Grid>
      </ControlTemplate>
      <ControlTemplate x:Key="EngravedContentTemplate" TargetType="ContentControl">
        <toggleswitch:DropShadowTextBlock
          Margin="{TemplateBinding Padding}"
          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
          HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
          VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
          Cursor="{TemplateBinding Cursor}"
          DropShadowAngle="90"
          DropShadowColor="#FFF7F7F7"
          DropShadowDistance="1"
          DropShadowOpacity="0.3"
          Focusable="False"
          FontFamily="{TemplateBinding FontFamily}"
          FontSize="{TemplateBinding FontSize}"
          FontStyle="{TemplateBinding FontStyle}"
          FontWeight="{TemplateBinding FontWeight}"
          Foreground="{TemplateBinding Foreground}"
          IsTabStop="False"
          Text="{TemplateBinding Content}" />
      </ControlTemplate>
      <ControlTemplate x:Key="HorizontalThumbTemplate" TargetType="Thumb">
        <Grid Background="Transparent">
          <borders:OuterGlowBorder
            Background="Transparent"
            BorderThickness="0"
            CornerRadius="4"
            OuterGlowColor="Black"
            OuterGlowOpacity="0.15"
            OuterGlowSize="4"
            ShadowCornerRadius="8">
            <Grid>
              <borders:ClippingBorder
                x:Name="Background"
                Background="White"
                BorderBrush="{TemplateBinding BorderBrush}"
                BorderThickness="{TemplateBinding BorderThickness}"
                CornerRadius="4">
                <Border
                  Background="{TemplateBinding Background}"
                  BorderBrush="#FFEBEBEB"
                  BorderThickness="1"
                  CornerRadius="3">
                  <Path
                    x:Name="path"
                    Margin="7,5"
                    Data="M3.6,2.6 L10,2.6 L10,6.6 L3.6,6.6 z M10,0 L15.5,4.6 L10,9.4 z"
                    Fill="#AA767676"
                    RenderTransformOrigin="0.5,0.5"
                    Stretch="Fill"
                    StrokeThickness="0">
                    <Path.RenderTransform>
                      <ScaleTransform />
                    </Path.RenderTransform>
                  </Path>
                </Border>
              </borders:ClippingBorder>
              <borders:ClippingBorder
                x:Name="BackgroundAnimation"
                Background="Black"
                BorderBrush="Black"
                BorderThickness="{TemplateBinding BorderThickness}"
                CornerRadius="4"
                Opacity="0" />
              <Rectangle
                x:Name="FocusVisualElement"
                Margin="1"
                IsHitTestVisible="True"
                Opacity="0"
                RadiusX="4"
                RadiusY="4"
                StrokeThickness="1" />
              <Rectangle
                x:Name="DisabledVisualElement"
                Fill="#FFFFFFFF"
                IsHitTestVisible="False"
                Opacity="0"
                RadiusX="4"
                RadiusY="4" />
            </Grid>
          </borders:OuterGlowBorder>
          <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="CommonStates">
              <VisualState x:Name="Normal" />
              <VisualState x:Name="MouseOver">
                <Storyboard>
                  <DoubleAnimation
                    Storyboard.TargetName="BackgroundAnimation"
                    Storyboard.TargetProperty="Opacity"
                    To="0.05"
                    Duration="0" />
                </Storyboard>
              </VisualState>
              <VisualState x:Name="Pressed">
                <Storyboard>
                  <DoubleAnimation
                    Storyboard.TargetName="BackgroundAnimation"
                    Storyboard.TargetProperty="Opacity"
                    To="0.25"
                    Duration="0" />
                </Storyboard>
              </VisualState>
              <VisualState x:Name="Disabled">
                <Storyboard>
                  <DoubleAnimation
                    Storyboard.TargetName="DisabledVisualElement"
                    Storyboard.TargetProperty="Opacity"
                    To=".55"
                    Duration="0" />
                </Storyboard>
              </VisualState>
            </VisualStateGroup>
            <VisualStateGroup x:Name="FocusStates">
              <VisualState x:Name="Focused">
                <Storyboard>
                  <DoubleAnimation
                    Storyboard.TargetName="FocusVisualElement"
                    Storyboard.TargetProperty="Opacity"
                    To="0.05"
                    Duration="0" />
                </Storyboard>
              </VisualState>
              <VisualState x:Name="Unfocused" />
            </VisualStateGroup>
            <VisualStateGroup x:Name="CheckStates">
              <VisualState x:Name="Unchecked" />
              <VisualState x:Name="Checked">
                <Storyboard>
                  <DoubleAnimation
                    Storyboard.TargetName="path"
                    Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                    To="-1"
                    Duration="0" />
                </Storyboard>
              </VisualState>
            </VisualStateGroup>
          </VisualStateManager.VisualStateGroups>
        </Grid>
      </ControlTemplate>
      <Style x:Key="SafariSwitchStyle" TargetType="toggleswitch:HorizontalToggleSwitch">
        <Setter Property="Width" Value="130" />
        <Setter Property="Height" Value="20" />
        <Setter Property="BorderBrush" Value="#FF6C6C6C" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Padding" Value="0,4" />
        <Setter Property="UncheckedForeground" Value="#FF3C3C3C" />
        <Setter Property="CheckedForeground" Value="#FF3C3C3C" />
        <Setter Property="FontSize" Value="12" />
        <Setter Property="ThumbSize" Value="30" />
        <Setter Property="ContentTemplate" Value="{StaticResource EngravedContentTemplate}" />
        <Setter Property="ThumbTemplate" Value="{StaticResource HorizontalThumbTemplate}" />
        <Setter Property="Background">
          <Setter.Value>
            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
              <GradientStop Offset="0" Color="#FF656565" />
              <GradientStop Offset="1" Color="#FFA5A5A5" />
              <GradientStop Offset="0.095" Color="#FF797979" />
            </LinearGradientBrush>
          </Setter.Value>
        </Setter>
        <Setter Property="ThumbBrush">
          <Setter.Value>
            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
              <GradientStop Offset="1" Color="#FFE1E1E1" />
              <GradientStop Color="#FFFBFBFB" />
            </LinearGradientBrush>
          </Setter.Value>
        </Setter>
        <Setter Property="Template">
          <Setter.Value>
            <ControlTemplate TargetType="toggleswitch:HorizontalToggleSwitch">
              <Grid>
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="Auto" />
                  <ColumnDefinition Width="*" />
                  <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <utils:ActualSizePropertyProxy
                  x:Name="ActualSizeProxy"
                  Element="{Binding Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                  IsHitTestVisible="False"
                  Visibility="Collapsed" />
                <ContentControl
                  x:Name="OffLabel"
                  Grid.Column="0"
                  Margin="0,0,6,0"
                  VerticalAlignment="Center"
                  HorizontalContentAlignment="Center"
                  VerticalContentAlignment="Center"
                  Content="{TemplateBinding UncheckedContent}"
                  Cursor="Hand"
                  Focusable="False"
                  FontFamily="{TemplateBinding FontFamily}"
                  FontSize="{TemplateBinding FontSize}"
                  FontStyle="{TemplateBinding FontStyle}"
                  FontWeight="{TemplateBinding FontWeight}"
                  Foreground="{TemplateBinding UncheckedForeground}"
                  IsTabStop="False" />
                <borders:ClippingBorder
                  x:Name="SwitchRoot"
                  Grid.Column="1"
                  Background="{TemplateBinding Background}"
                  BorderBrush="{TemplateBinding BorderBrush}"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  CornerRadius="2"
                  Cursor="Hand"
                  IsTabStop="False">
                  <Canvas
                    x:Name="SwitchTrack"
                    Height="{TemplateBinding Height}"
                    Margin="0,-1,0,0"
                    Cursor="Hand">
                    <Thumb
                      x:Name="SwitchThumb"
                      Width="{TemplateBinding ThumbSize}"
                      Height="{Binding ActualHeightValue, ElementName=ActualSizeProxy}"
                      HorizontalAlignment="Left"
                      Background="{TemplateBinding ThumbBrush}"
                      Cursor="Hand"
                      IsTabStop="False"
                      Template="{StaticResource SafariThumbControlTemplate}" />
                  </Canvas>
                </borders:ClippingBorder>
                <ContentControl
                  x:Name="OnLabel"
                  Grid.Column="2"
                  Margin="6,0,0,0"
                  VerticalAlignment="Center"
                  HorizontalContentAlignment="Center"
                  VerticalContentAlignment="Center"
                  Content="{TemplateBinding CheckedContent}"
                  Cursor="Hand"
                  Focusable="False"
                  FontFamily="{TemplateBinding FontFamily}"
                  FontSize="{TemplateBinding FontSize}"
                  FontStyle="{TemplateBinding FontStyle}"
                  FontWeight="{TemplateBinding FontWeight}"
                  Foreground="{TemplateBinding CheckedForeground}"
                  IsTabStop="False" />
                <Border
                  x:Name="DisabledOverlay"
                  Grid.Column="1"
                  Height="27"
                  Background="#AAEEEEEE"
                  CornerRadius="4"
                  Visibility="Collapsed" />
                <VisualStateManager.VisualStateGroups>
                  <VisualStateGroup x:Name="CommonStates">
                    <VisualState x:Name="Normal" />
                    <VisualState x:Name="Disabled">
                      <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="DisabledOverlay" Storyboard.TargetProperty="(UIElement.Visibility)">
                          <DiscreteObjectKeyFrame KeyTime="0">
                            <DiscreteObjectKeyFrame.Value>
                              <Visibility>Visible</Visibility>
                            </DiscreteObjectKeyFrame.Value>
                          </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                      </Storyboard>
                    </VisualState>
                    <VisualState x:Name="MouseOver" />
                    <VisualState x:Name="Pressed" />
                  </VisualStateGroup>
                  <VisualStateGroup x:Name="CheckStates">
                    <VisualStateGroup.Transitions>
                      <VisualTransition GeneratedDuration="0:0:0.10" To="Unchecked" />
                      <VisualTransition GeneratedDuration="0:0:0.10" To="Checked" />
                    </VisualStateGroup.Transitions>
                    <VisualState x:Name="Checked" />
                    <VisualState x:Name="Unchecked" />
                    <VisualState x:Name="DraggingChecked" />
                    <VisualState x:Name="DraggingUnchecked" />
                  </VisualStateGroup>
                </VisualStateManager.VisualStateGroups>
              </Grid>
            </ControlTemplate>
          </Setter.Value>
        </Setter>
      </Style>
      <Style
        x:Key="TextBoxStyle1"
        BasedOn="{x:Null}"
        TargetType="{x:Type TextBox}">
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="AllowDrop" Value="true" />
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="ScrollViewer.PanningMode" Value="VerticalFirst" />
        <Setter Property="Stylus.IsFlicksEnabled" Value="False" />
        <Setter Property="Template">
          <Setter.Value>
            <ControlTemplate TargetType="{x:Type TextBox}">
              <Border
                x:Name="border"
                Background="White"
                BorderBrush="Black"
                BorderThickness="1"
                CornerRadius="0">
                <ScrollViewer
                  x:Name="PART_ContentHost"
                  Margin="1"
                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
              </Border>
              <ControlTemplate.Triggers>
                <Trigger Property="IsFocused" Value="True">
                  <Setter TargetName="border" Property="BorderBrush" Value="Black" />
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                  <Setter TargetName="border" Property="Opacity" Value="1" />
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                  <Setter TargetName="border" Property="BorderBrush" Value="Black" />
                </Trigger>
              </ControlTemplate.Triggers>
            </ControlTemplate>
          </Setter.Value>
        </Setter>
      </Style>
    </ResourceDictionary>
  </Ribbon:RibbonWindow.Resources>

  <Grid x:Name="grid1">
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="186*" />
      <ColumnDefinition Width="25*" />
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
      <RowDefinition x:Name="rRibbon" Height="Auto" />
      <RowDefinition x:Name="rCommands" Height="36" />
      <RowDefinition x:Name="NavPanelDivider" Height="Auto" />
      <RowDefinition x:Name="rTabbarTop" Height="25" />
      <RowDefinition Height="*" />
      <RowDefinition x:Name="spCommandPrompt" Height="Auto" />
      <RowDefinition
        x:Name="rCommandPrompt"
        Height="*"
        MinHeight="100" />
      <RowDefinition x:Name="rTabbarBot" Height="0" />
      <RowDefinition x:Name="rStatusbar" Height="20" />
    </Grid.RowDefinitions>

    <ni:TaskbarIcon
      x:Name="beNotifyIcon"
      Grid.ColumnSpan="2"
      IconSource="Explorer.ico"
      MenuActivation="RightClick"
      PopupActivation="DoubleClick"
      ToolTipText="{DynamicResource beNotifyIcon_ToolTipText}"
      TrayMouseDoubleClick="beNotifyIcon_TrayMouseDoubleClick"
      Visibility="Visible">
      <ni:TaskbarIcon.ContextMenu>
        <ContextMenu>
          <MenuItem Click="beNotifyIcon_TrayMouseDoubleClick" Header="Show Window" />
          <MenuItem Click="btnBackstageExit_Click" Header="Exit" />
        </ContextMenu>
      </ni:TaskbarIcon.ContextMenu>
    </ni:TaskbarIcon>
    <Ribbon:Ribbon
      x:Name="TheRibbon"
      Grid.ColumnSpan="2"
      Background="White"
      CanCustomizeQuickAccessToolBar="True"
      CustomizeQuickAccessToolbar="TheRibbon_CustomizeQuickAccessToolbar"
      Focusable="False">
      <!--  SizeChanged="TheRibbon_SizeChanged"  -->
      <Ribbon:Ribbon.ToolBarItems>
        <Ribbon:Button
          x:Name="btnAbout"
          Ribbon:KeyTip.Keys="B"
          Click="btnAbout_Click"
          Icon="Images\about16.png"
          SizeDefinition="Small,Small,Small"
          Visibility="Collapsed" />
      </Ribbon:Ribbon.ToolBarItems>
      <Ribbon:Ribbon.QuickAccessItems>
        <Ribbon:QuickAccessMenuItem
          Focusable="False"
          IsChecked="True"
          Target="{Binding ElementName=btnCut}" />
        <Ribbon:QuickAccessMenuItem
          Focusable="False"
          IsChecked="True"
          Target="{Binding ElementName=btnCopy}" />
        <Ribbon:QuickAccessMenuItem
          Focusable="False"
          IsChecked="True"
          Target="{Binding ElementName=btnPaste}" />
        <Ribbon:QuickAccessMenuItem
          Focusable="False"
          IsChecked="True"
          Target="{Binding ElementName=btnNewTab}" />
        <Ribbon:QuickAccessMenuItem
          Focusable="False"
          IsChecked="True"
          Target="{Binding ElementName=btnTabClone}" />
        <Ribbon:QuickAccessMenuItem
          Focusable="False"
          IsChecked="False"
          Target="{Binding ElementName=btnNewWindow}" />
        <Ribbon:QuickAccessMenuItem
          Focusable="False"
          IsChecked="False"
          Target="{Binding ElementName=btnNavigationPane}" />
        <Ribbon:QuickAccessMenuItem
          Focusable="False"
          IsChecked="False"
          Target="{Binding ElementName=btnPreviewPane}" />
        <Ribbon:QuickAccessMenuItem
          Focusable="False"
          IsChecked="False"
          Target="{Binding ElementName=btnInfoPane}" />
      </Ribbon:Ribbon.QuickAccessItems>
      <Ribbon:Ribbon.Menu>
        <Ribbon:Backstage
          x:Name="backstage"
          Ribbon:KeyTip.Keys="F"
          Background="DarkOrange"
          Header="Menu"
          Focusable="False"
          FontStretch="Expanded"
          FontStyle="Normal"
          FontWeight="Normal"
          IsOpenChanged="backstage_IsOpenChanged">
          <Ribbon:BackstageTabControl>
            <Ribbon:Button
              x:Name="btnNewWindow"
              Ribbon:KeyTip.Keys="N"
              Click="btnNewWindow_Click"
              Content="New Window"
              Header="{DynamicResource btnNewWindowCP}"
              Icon="Images\new_window.png" />
            <Ribbon:BackstageTabItem
              Ribbon:KeyTip.Keys="I"
              Header="{DynamicResource btiInformationCP}"
              Visibility="Visible">
              <Grid>
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="2*" />
                  <ColumnDefinition Width="3*" />
                </Grid.ColumnDefinitions>
                <Ribbon:SeparatorTabItem
                  Margin="15,10,10,0"
                  VerticalAlignment="Top"
                  Header="{DynamicResource mmSupportCP}"
                  Style="{DynamicResource InnerBackstageSeparatorTabItemStyle}" />
                <Ribbon:Button
                  x:Name="btnUpdateCheck"
                  Height="88"
                  Margin="20,45,0,0"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  Ribbon:KeyTip.AutoPlacement="False"
                  Ribbon:KeyTip.HorizontalAlignment="Center"
                  Ribbon:KeyTip.Keys="U"
                  Ribbon:KeyTip.VerticalAlignment="Bottom"
                  Click="Button_Click_6"
                  Header="{DynamicResource btnUpdateCheckCP}"
                  Icon="Images\updater16.png"
                  IsDefinitive="False"
                  LargeIcon="Images\updater32.png"
                  Style="{DynamicResource ButtonBackstageStyle}">
                  <Ribbon:Button.ToolTip>
                    <Ribbon:ScreenTip
                      Title="{DynamicResource btnUpdateCheckHCP}"
                      Width="250"
                      DisableReason="{DynamicResource btnUpdateCheckHCP_DisableReason}"
                      IsRibbonAligned="false"
                      Text="{DynamicResource btnUpdateCheckICP}" />
                  </Ribbon:Button.ToolTip>
                </Ribbon:Button>
                <Label
                  Margin="105,45,10,0"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  Content="{DynamicResource btnUpdateCheckHCP}"
                  FontSize="12"
                  FontWeight="Bold"
                  Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                <TextBlock
                  Height="50"
                  Margin="110,75,10,0"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                  Text="{DynamicResource btnUpdateCheckICP}"
                  TextWrapping="Wrap" />
                <Ribbon:Button
                  Height="88"
                  Margin="20,140,0,0"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  Ribbon:KeyTip.AutoPlacement="False"
                  Ribbon:KeyTip.HorizontalAlignment="Center"
                  Ribbon:KeyTip.Keys="W"
                  Ribbon:KeyTip.VerticalAlignment="Bottom"
                  Click="Button_Click_7"
                  Header="{DynamicResource btnOpenWebsite}"
                  Icon="Images\webconnect_16.png"
                  IsDefinitive="True"
                  LargeIcon="Images\webconnect_32.png"
                  Style="{DynamicResource ButtonBackstageStyle}" />
                <Label
                  Margin="105,140,10,0"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  Content="{DynamicResource btnOpenWebsiteHCP}"
                  FontSize="12"
                  FontWeight="Bold"
                  Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                <TextBlock
                  Height="50"
                  Margin="110,170,10,0"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                  Text="{DynamicResource btnOpenWebsiteICP}"
                  TextWrapping="Wrap" />
                <Ribbon:Button
                  Height="88"
                  Margin="20,235,0,0"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  Ribbon:KeyTip.AutoPlacement="False"
                  Ribbon:KeyTip.HorizontalAlignment="Center"
                  Ribbon:KeyTip.Keys="R"
                  Ribbon:KeyTip.VerticalAlignment="Bottom"
                  Click="btnBugtracker_Click"
                  Header="{DynamicResource btnBugtracker}"
                  Icon="Images\bugtrac_16.png"
                  IsDefinitive="True"
                  LargeIcon="Images\bugtrac_32.png"
                  Style="{DynamicResource ButtonBackstageStyle}" />
                <Button
                  x:Name="btnPaypal"
                  Width="280"
                  Height="140"
                  Margin="20,350,0,0"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  Click="btnPaypal_Click"
                  Cursor="Hand">
                  <Image
                    Width="253"
                    Height="120"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Source="Images\paypal.png" />
                </Button>
                <Label
                  x:Name="lbeBugtracker"
                  Margin="105,235,10,0"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  Content="{DynamicResource lbeBugtracker}"
                  FontSize="12"
                  FontWeight="Bold"
                  Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                <TextBlock
                  x:Name="txtBugtracker"
                  Height="50"
                  Margin="110,265,10,0"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                  Text="{DynamicResource txtBugtracker}"
                  TextWrapping="Wrap" />
                <Separator Grid.Column="0" HorizontalAlignment="Right" />
                <Image
                  Grid.Column="1"
                  Width="400"
                  Height="100"
                  Margin="10,20,0,0"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  Source="Images\bexplorerlogo.png"
                  Stretch="Fill" />
                <ScrollViewer
                  Grid.Column="1"
                  Margin="20,110,10,0"
                  HorizontalScrollBarVisibility="Auto"
                  VerticalScrollBarVisibility="Auto">
                  <StackPanel Margin="1,0,0,1">
                    <!--<Controls:AutomaticUpdater
                      x:Name="autoUpdater"
                      Margin="0,15,30,10"
                      HorizontalAlignment="Left"
                      Panel.ZIndex="100"
                      Animate="True"
                      DaysBetweenChecks="7"
                      Focusable="False"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      KeepExpanded="True"
                      UpdateType="OnlyCheck" />
                    <Label
                      x:Name="stiUpdate"
                      Margin="0,25,50,0"
                      Content="{DynamicResource stUpdateNotAvailableCP}"
                      FontSize="14"
                      FontWeight="ExtraBold"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Visibility="Collapsed" />-->
                    <Ribbon:SeparatorTabItem
                      Margin="0,-30,50,0"
                      Foreground="#FFC71212"
                      Header=""
                      Style="{DynamicResource InnerBackstageSeparatorTabItemStyle}" />
                    <Label
                      Margin="0,2,50,0"
                      Content="{DynamicResource lblBetterExText}"
                      FontWeight="Bold"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                    <TextBlock
                      Width="500"
                      Margin="3,2,53,0"
                      HorizontalAlignment="Left"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Text="{DynamicResource lblBetterExInfo}"
                      TextWrapping="Wrap" />
                    <Ribbon:SeparatorTabItem
                      Margin="0,20,50,0"
                      Header="{DynamicResource lblDevTeamCP}"
                      Style="{DynamicResource InnerBackstageSeparatorTabItemStyle}" />
                    <Label
                      Margin="0,2,50,0"
                      Content="{DynamicResource lblDevelopersHeader}"
                      FontWeight="Bold"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                    <Label
                      Margin="20,0,40,0"
                      Content="Dimitar Tsenev"
                      FontSize="14"
                      FontStyle="Italic"
                      FontWeight="Bold"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                    <Label
                      Margin="20,0,40,0"
                      Content="Timo Kunze"
                      FontSize="14"
                      FontStyle="Italic"
                      FontWeight="DemiBold"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                    <Label
                      Margin="20,0,40,0"
                      Content="Aaron Campf"
                      FontSize="14"
                      FontStyle="Italic"
                      FontWeight="DemiBold"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                    <Label
                      Margin="20,0,40,0"
                      Content="Markus Lang"
                      FontSize="14"
                      FontStyle="Normal"
                      FontWeight="Normal"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                    <Label
                      Margin="20,0,40,0"
                      Content="Jayke R. Huempfner (JaykeBird)"
                      FontSize="14"
                      FontStyle="Normal"
                      FontWeight="Normal"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                    <!--<Label Margin="20,0,40,0"
                               Content="Alexey Barkalov"
                               FontSize="14"
                               FontStyle="Italic"
                               FontWeight="Bold" />-->
                    <Ribbon:SeparatorTabItem
                      Margin="0,20,50,0"
                      Header="{DynamicResource lblAboutBEHeader}"
                      Style="{DynamicResource InnerBackstageSeparatorTabItemStyle}" />
                    <Label
                      x:Name="verNumber"
                      Margin="20,0,50,0"
                      Content="Version Info Data Put Here"
                      FontSize="12"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                    <Label
                      x:Name="lblArchitecture"
                      Margin="20,0,0,0"
                      Content="32-bit Version"
                      FontSize="12"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                    <Label
                      Margin="20,0,0,0"
                      Content="© 2017. All right reserved."
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                    <Ribbon:SeparatorTabItem
                      Margin="0,20,50,0"
                      Header="Credits"
                      Style="{DynamicResource InnerBackstageSeparatorTabItemStyle}" />
                    <Label Content="Fluent Ribbon Control Suite (https://github.com/fluentribbon/Fluent.Ribbon)" Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                    <!--  <Label Content="Qttabbar - a great utility for Windows Explorer"/>  -->
                    <Label Content="7-Zip - archiving utility (www.7-zip.org)" Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                    <Label Content="7ZipSharp - a wrapper of 7Zip for .NET" Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                    <Label Content="Some icons are property of Microsoft® Corporation. All right reserved." Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                  </StackPanel>
                </ScrollViewer>

              </Grid>
            </Ribbon:BackstageTabItem>
            <Ribbon:BackstageTabItem Ribbon:KeyTip.Keys="O" Header="{DynamicResource btiOptionsCP}">
              <TabControl Margin="20,5,20,5" Style="{DynamicResource InnerBackstageTabControlStyle}">
                <Ribbon:SeparatorTabItem Header="{DynamicResource sepGeneral}" />
                <TabItem
                  Ribbon:KeyTip.Keys="S"
                  Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                  Header="{DynamicResource tabShell}"
                  IsSelected="True">
                  <StackPanel
                    x:Name="ShellStack"
                    Margin="20,5,0,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Focusable="True"
                    Orientation="Vertical">
                    <Ribbon:SeparatorTabItem Header="{DynamicResource sepStartup}" />
                    <StackPanel Margin="0,5,0,0" Orientation="Horizontal">
                      <!--
                                            Ribbon:TextBox Name="txtPath" Width="200"/>
                                            <Button Name="btnPathPick" Content="..." Width="22" HorizontalContentAlignment="Center" Height="22" Click="btnPathPick_Click" /
                      -->
                      <Border
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch"
                        BorderBrush="#FF000000"
                        BorderThickness="1">
                        <Ribbon:Button
                          x:Name="btnSetCurrentasStartup"
                          Width="Auto"
                          Margin="0"
                          Padding="5,0,5,0"
                          Ribbon:KeyTip.Keys="S"
                          BorderBrush="Black"
                          BorderThickness="1"
                          CanAddToQuickAccessToolBar="True"
                          Click="btnSetCurrentasStartup_Click"
                          Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                          Header="Libraries">
                          <Ribbon:Button.ToolTip>
                            <Ribbon:ScreenTip
                              Title="{DynamicResource btnSetCurrentasStartupHCP}"
                              Width="250"
                              IsRibbonAligned="false"
                              Text="{DynamicResource btnSetCurrentasStartupICP}" />
                          </Ribbon:Button.ToolTip>
                        </Ribbon:Button>
                      </Border>
                      <Label
                        Margin="3,0,0,0"
                        Content="{DynamicResource btnSetCurrentasStartupDesc}"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                    </StackPanel>
                    <Label x:Name="paddinglbl1" Content="         " />
                    <Ribbon:SeparatorTabItem
                      x:Name="stiOtherSettings"
                      Margin="0,0,0,15"
                      Header="{DynamicResource stiOtherSettings}" />
                    <StackPanel Orientation="Horizontal">
                      <Ribbon:CheckBox
                        x:Name="chkIsDefault"
                        Ribbon:KeyTip.Keys="V"
                        Checked="chkIsDefault_CheckChanged"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        Header="{DynamicResource chkIsDefault}"
                        Unchecked="chkIsDefault_CheckChanged">
                        <Ribbon:CheckBox.ToolTip>
                          <!--  Title="{DynamicResource chkIsDefaultHCP}"  -->
                          <Ribbon:ScreenTip
                            Title="{DynamicResource chkIsDefault}"
                            Width="250"
                            DisableReason="{DynamicResource chkIsDefault_DisableReason}"
                            Image="Images\uac48.png"
                            IsRibbonAligned="false"
                            Text="{DynamicResource chkIsDefaultICP}" />
                        </Ribbon:CheckBox.ToolTip>
                      </Ribbon:CheckBox>
                      <Image Source="Images\uac16.png" />
                    </StackPanel>
                    <Label x:Name="paddinglbl6" Content="         " />
                    <Ribbon:CheckBox
                      x:Name="chkIsTerraCopyEnabled"
                      Ribbon:KeyTip.Keys="T"
                      Checked="chkIsTerraCopyEnabled_CheckChanged"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Header="{DynamicResource chkIsTerraCopyEnabled}"
                      Unchecked="chkIsTerraCopyEnabled_CheckChanged">
                      <Ribbon:CheckBox.ToolTip>
                        <!--  Title="{DynamicResource chkIsTerraCopyEnabledHCP}"  -->
                        <Ribbon:ScreenTip
                          Title="{DynamicResource chkIsTerraCopyEnabled}"
                          Width="250"
                          IsRibbonAligned="false"
                          Text="{DynamicResource chkIsTerraCopyEnabledICP}" />
                      </Ribbon:CheckBox.ToolTip>
                    </Ribbon:CheckBox>
                    <Label x:Name="paddinglbl7" Content="         " />
                    <!--
            <Ribbon:CheckBox Name="chkIsCompartibleRename" Header="{DynamicResource chkIsCompartibleRename}" Ribbon:KeyTip.Keys="R" Checked="chkIsCompartibleRename_Checked" Unchecked="chkIsCompartibleRename_Unchecked">
            <Ribbon:CheckBox.ToolTip>
            <Ribbon:ScreenTip
            Title="{DynamicResource chkIsCompartibleRenameHCP}"
            Text="{DynamicResource chkIsCompartibleRenameICP}"
            Width="250"
            IsRibbonAligned ="false"/>
            </Ribbon:CheckBox.ToolTip>
            </Ribbon:CheckBox>
            <Label Name="paddinglbl8" Content="         "/>
                    -->
                    <Ribbon:CheckBox
                      x:Name="chkIsCFO"
                      Ribbon:KeyTip.Keys="C"
                      Click="chkIsCFO_Click"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Header="{DynamicResource chkIsCFO}"
                      IsEnabled="False">
                      <Ribbon:CheckBox.ToolTip>
                        <Ribbon:ScreenTip
                          Title="{DynamicResource chkIsCFO_Tooltip_Title}"
                          Width="250"
                          IsRibbonAligned="false"
                          Text="{DynamicResource chkIsCFO_Tooltip_Text}" />
                      </Ribbon:CheckBox.ToolTip>
                    </Ribbon:CheckBox>
                    <Label Content="         " />
                    <Ribbon:CheckBox
                      x:Name="chkIsRestoreTabs"
                      Ribbon:KeyTip.Keys="R"
                      Checked="chkIsRestoreTabs_CheckChanged"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Header="{DynamicResource cbIsResttoreCP}"
                      Unchecked="chkIsRestoreTabs_CheckChanged">
                      <Ribbon:CheckBox.ToolTip>
                        <Ribbon:ScreenTip
                          Title="{DynamicResource cbIsResttoreCP}"
                          Width="250"
                          IsRibbonAligned="false"
                          Text="{DynamicResource cbIsResttoreTTX}" />
                      </Ribbon:CheckBox.ToolTip>
                    </Ribbon:CheckBox>
                    <!--  (This is a hidden setting. Use the "IsVistaStyleListView" Registry key to change this setting.)  -->
                    <Label Content="         " Visibility="Collapsed" />
                    <!--
            <Ribbon:CheckBox x:Name="chkOldSysListView"
            Checked="chkIsVistaStyleListView_Checked"
            Ribbon:KeyTip.Keys="V"
            Unchecked="chkIsVistaStyleListView_Unchecked" Header="{DynamicResource txtIsVistaStyleListView}"
            Visibility="Collapsed">
            <Ribbon:CheckBox.ToolTip>
            <Ribbon:ScreenTip Title="{DynamicResource txtIsVistaStyleListView}"
            Width="250"
            IsRibbonAligned="false"
            Text="{DynamicResource txtIsVistaStyleListViewTTX}" />
            </Ribbon:CheckBox.ToolTip>
            </Ribbon:CheckBox>
          -->
                    <Label Content="         " />
                    <Ribbon:CheckBox
                      x:Name="chkTraditionalNameGrouping"
                      Ribbon:KeyTip.Keys="TNR"
                      Checked="chkTraditionalNameGrouping_CheckChanged"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Header="Traditional Name Grouping"
                      Unchecked="chkTraditionalNameGrouping_CheckChanged">
                      <Ribbon:CheckBox.ToolTip>
                        <Ribbon:ScreenTip
                          Title="Traditional Name Grouping"
                          Width="250"
                          IsRibbonAligned="false"
                          Text="Traditional Name Grouping" />
                      </Ribbon:CheckBox.ToolTip>
                    </Ribbon:CheckBox>
                    <Label
                      x:Name="paddinglbl8"
                      Content="         "
                      Visibility="Collapsed" />
                    <Ribbon:CheckBox
                      x:Name="chkLogHistory"
                      Ribbon:KeyTip.Keys="L"
                      Checked="chkLogHistory_CheckChanged"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Header="{DynamicResource chkLogHistoryCP}"
                      Unchecked="chkLogHistory_CheckChanged"
                      Visibility="Collapsed">
                      <Ribbon:CheckBox.ToolTip>
                        <Ribbon:ScreenTip
                          Title="{DynamicResource chkLogHistoryCP}"
                          Width="250"
                          IsRibbonAligned="false"
                          Text="{DynamicResource chkLogHistoryHCP}" />
                      </Ribbon:CheckBox.ToolTip>
                    </Ribbon:CheckBox>
                    <Border
                      x:Name="ShowLogsBorder"
                      HorizontalAlignment="Left"
                      BorderBrush="#FF000000"
                      BorderThickness="1"
                      Visibility="Collapsed">
                      <Ribbon:Button
                        x:Name="btnShowLogs"
                        Width="125"
                        Height="22"
                        Margin="0"
                        HorizontalAlignment="Left"
                        Ribbon:KeyTip.Keys="H"
                        BorderBrush="Black"
                        BorderThickness="1"
                        Click="btnShowLogs_Click"
                        Header="Show All Logs"
                        Icon="Images\open16.png" />
                    </Border>
                  </StackPanel>
                </TabItem>
                <TabItem
                  Ribbon:KeyTip.Keys="L"
                  Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                  Header="{DynamicResource tabLanguageCP}"
                  Visibility="Visible">
                  <StackPanel Margin="20,5,0,0" Orientation="Vertical">
                    <Ribbon:SeparatorTabItem Header="{DynamicResource sepLanguageCP}" />
                    <Label Content="{DynamicResource lblLanguageCP}" Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                    <Label
                      Content="{DynamicResource lblLanguageCP_2}"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Visibility="Collapsed" />
                    <!--  <TextBox Name="txtLocale" HorizontalAlignment="Left" Margin="0,5,0,0" Width="100" Height="23" />  -->
                    <!--  <Button Name="btnchangeLocale" Content="Change Locale" Width="90" HorizontalAlignment="Left" Margin="0,5,0,0" HorizontalContentAlignment="Center" Height="22" Click="btnchangeLocale_Click" />  -->
                    <!--  <Label Content="Supported codes:" Margin="0,5,0,0" />  -->
                    <!--  <Label Content="en-US - English(US)" Margin="0,0,0,0" />  -->
                    <!--  <Label Content="bg-BG - Bulgarian" Margin="0,0,0,0" />  -->
                    <Ribbon:ComboBox
                      x:Name="TranslationComboBox"
                      Width="250"
                      Height="40"
                      Margin="0,5,0,0"
                      HorizontalAlignment="Left"
                      HorizontalContentAlignment="Stretch"
                      CanAddToQuickAccessToolBar="False"
                      DropDownHeight="200"
                      DropDownOpened="TranslationComboBox_DropDownOpened"
                      SelectionChanged="TranslationComboBox_SelectionChanged"
                      Style="{DynamicResource ComboBoxBackstageStyle}">
                      <controls:TranslationComboBoxItem
                        x:Name="nullLang"
                        LanguageText="Use OS GUI Language"
                        LocaleCode=":null:"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="bgBGLang"
                        CountryFlag="Translation\Flags\BG.gif"
                        LanguageText="Bulgarian (Български)"
                        LocaleCode="bg-BG"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="hrHRLang"
                        CountryFlag="Translation\Flags\HR.gif"
                        LanguageText="Croatian"
                        LocaleCode="hr-HR"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="zhCNLang"
                        CountryFlag="Translation\Flags\CN.gif"
                        LanguageText="Chinese (Simplified)"
                        LocaleCode="zh-CN"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="zhTWLang"
                        CountryFlag="Translation\Flags\TW.gif"
                        LanguageText="Chinese (Traditional)"
                        LocaleCode="zh-TW"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="csCZLang"
                        CountryFlag="Translation\Flags\CZ.gif"
                        LanguageText="Czech"
                        LocaleCode="cs-CZ"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="nlNLLang"
                        CountryFlag="Translation\Flags\NL.gif"
                        LanguageText="Dutch"
                        LocaleCode="nl-NL"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="enGBLang"
                        CountryFlag="Translation\Flags\GB.gif"
                        LanguageText="English (UK)"
                        LocaleCode="en-GB"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="enUSLang"
                        CountryFlag="Translation\Flags\US.gif"
                        LanguageText="English (US)"
                        LocaleCode="en-US"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="fiFILang"
                        CountryFlag="Translation\Flags\FI.gif"
                        LanguageText="Finnish"
                        LocaleCode="fi-FI"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="frFRLang"
                        CountryFlag="Translation\Flags\FR.gif"
                        LanguageText="French"
                        LocaleCode="fr-FR"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="deDELang"
                        CountryFlag="Translation\Flags\DE.gif"
                        LanguageText="German"
                        LocaleCode="de-DE"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="elGRLang"
                        CountryFlag="Translation\Flags\GR.gif"
                        LanguageText="Greek"
                        LocaleCode="el-GR"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="huHULang"
                        CountryFlag="Translation\Flags\HU.gif"
                        LanguageText="Hungarian"
                        LocaleCode="hu-HU"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="itITLang"
                        CountryFlag="Translation\Flags\IT.gif"
                        LanguageText="Italian"
                        LocaleCode="it-IT"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="jaJALang"
                        CountryFlag="Translation\Flags\JP.gif"
                        LanguageText="Japanese (日本語)"
                        LocaleCode="ja-JP"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="koKRLang"
                        CountryFlag="Translation\Flags\KR.gif"
                        LanguageText="Korean"
                        LocaleCode="ko-KR"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="plPLLang"
                        CountryFlag="Translation\Flags\PL.gif"
                        LanguageText="Polish"
                        LocaleCode="pl-PL"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="ptBRLang"
                        CountryFlag="Translation\Flags\BR.gif"
                        LanguageText="Portuguese"
                        LocaleCode="pt-BR"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="ruRULang"
                        CountryFlag="Translation\Flags\RU.gif"
                        LanguageText="Russian"
                        LocaleCode="ru-RU"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="esESLang"
                        CountryFlag="Translation\Flags\ES.gif"
                        LanguageText="Spanish"
                        LocaleCode="es-ES"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="svSELang"
                        CountryFlag="Translation\Flags\SE.gif"
                        LanguageText="Swedish"
                        LocaleCode="sv-SE"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="trTRLang"
                        CountryFlag="Translation\Flags\TR.gif"
                        LanguageText="Turkish"
                        LocaleCode="tr-TR"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="ukUALang"
                        CountryFlag="Translation\Flags\UA.gif"
                        LanguageText="Ukrainian"
                        LocaleCode="uk-UA"
                        UsesRTL="False" />
                      <controls:TranslationComboBoxItem
                        x:Name="viVNLang"
                        CountryFlag="Translation\Flags\VN.gif"
                        LanguageText="Vietnamese"
                        LocaleCode="vi-VN"
                        UsesRTL="False" />
                    </Ribbon:ComboBox>
                    <Label Content="   " />
                    <Ribbon:SeparatorTabItem Header="{DynamicResource txtTranslationHelp}" Style="{DynamicResource InnerBackstageSeparatorTabItemStyle}" />
                    <TextBlock Margin="0,5,0,0" Text="{DynamicResource txtHelpWebpage}" />
                    <Button
                      x:Name="TranslationHelp"
                      HorizontalAlignment="Left"
                      Background="#01000000"
                      BorderBrush="#01000000"
                      Click="TranslationHelp_Click"
                      Foreground="#FFFF6E00">
                      <TextBlock
                        x:Name="TranslationURL"
                        Text="http://better-explorer.com/help-with-translating/"
                        TextDecorations="Underline" />
                    </Button>
                    <TextBlock Margin="0,10,0,5" Text="{DynamicResource txtTranslationCredits}" />
                    <TextBlock Text="Bulgarian: Dimitar Tsenev" />
                    <TextBlock Text="Chinese: Robin Zhang, Diluka W, lrh3321, ky911223" />
                    <TextBlock Text="Croatian: Smeker (Danijel Levak)" />
                    <TextBlock Text="Czech: Stanislav Pokorný" />
                    <TextBlock Text="Dutch: Pink-ET" />
                    <TextBlock Text="English: JaykeBird (Jayke R. Huempfner), Dimitar Tsenev" />
                    <TextBlock Text="Finnish: Osku598 (Oskar Bredin)" />
                    <TextBlock Text="French: Sebastien Kerguen, Pascal Huau, reno2012" />
                    <TextBlock Text="German: Stefan Klebs, Markus Lang, Florian0901, Piotrex, Daniel Will" />
                    <TextBlock Text="Greek: Ιωάννης Τσιμπέρης" />
                    <TextBlock Text="Hindi: Animesh Prasad" />
                    <TextBlock Text="Hungarian: lostprophet (Brechler Zsolt)" />
                    <TextBlock Text="Italian: Gianluigi Meraviglia, eagleman, inshilon, JaykeBird (Jayke R. Huempfner)" />
                    <TextBlock Text="Japanse: Kensuke Sasaki" />
                    <TextBlock Text="Korean: Park Yuncheol" />
                    <TextBlock Text="Polish: VorbisMastah, Krzysztof, pbl3" />
                    <TextBlock Text="Portuguese: Cléverson, brenochamie, unforgiving" />
                    <TextBlock Text="Russian: Loungedy, olerapx, Alexey Barkalov" />
                    <TextBlock Text="Spanish: JMBolivar (José Miguel Bolivar)" />
                    <TextBlock Text="Swedish: toando1, masterjaz, samosante" />
                    <TextBlock Text="Turkish: Cengizhan, Loungedy" />
                    <TextBlock Text="Ukrainian: Venorme" />
                    <TextBlock Text="Vietnamese: 7on7off" />
                    <!--
            <Ribbon:SeparatorTabItem Header="Remove Setting" Visibility="Hidden"/>
            <TextBlock TextWrapping="Wrap" HorizontalAlignment="Left" Margin="0,0,60,0" Visibility="Hidden"
            Text="Because this build updates the Registry after installation, there would be a Registry error if
            this build were deleted and BetterExplorer uninstalled. Therefore, until the next release and this Registry setting is set during installation,
            this feature will be provided in case you wish to remove and uninstall BetterExplorer altogether. If you delete the Registry setting, it will be
            re-applied next time you start BetterExplorer. Only use this if you plan on uninstalling BetterExplorer after this." />
            <Button Name="btnRemoveLangSetting" Margin="0,5,0,0" Content="Remove This Setting" Click="btnRemoveLangSetting_Click" HorizontalAlignment="Left" Width="120" Visibility="Hidden"/>
          -->
                  </StackPanel>
                </TabItem>
                <TabItem
                  HorizontalContentAlignment="Left"
                  Ribbon:KeyTip.Keys="U"
                  Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                  Header="{DynamicResource tabUpdateCP}">
                  <Grid Margin="20,5,0,0">
                    <Ribbon:SeparatorTabItem
                      VerticalAlignment="Top"
                      Header="{DynamicResource txtAutoUpdate}"
                      Style="{DynamicResource InnerBackstageSeparatorTabItemStyle}" />
                    <Ribbon:CheckBox
                      x:Name="chkUpdateCheck"
                      Margin="5,30,0,0"
                      VerticalAlignment="Top"
                      Checked="CheckBox_Checked"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Header="Check for updates"
                      Unchecked="CheckBox_Unchecked" />
                    <Ribbon:CheckBox
                      x:Name="chkUpdateStartupCheck"
                      Margin="5,50,0,0"
                      VerticalAlignment="Top"
                      Click="chkUpdateStartupCheck_Click"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Header="{DynamicResource chkAutoCheck}" />
                    <TextBlock
                      Margin="5,80,0,0"
                      VerticalAlignment="Top"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Text="When an update is available:"
                      Visibility="Collapsed" />
                    <StackPanel
                      Margin="5,100,0,0"
                      VerticalAlignment="Top"
                      Orientation="Vertical"
                      Visibility="Collapsed">
                      <Ribbon:RadioButton GroupName="uas" Header="Notify me only" />
                      <Ribbon:RadioButton GroupName="uas" Header="Download, but do not install" />
                      <Ribbon:RadioButton GroupName="uas" Header="Download and install update" />
                    </StackPanel>
                    <TextBlock
                      Margin="5,80,0,0"
                      VerticalAlignment="Top"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Text="{DynamicResource txtCheckHowOften}" />
                    <StackPanel
                      Margin="5,100,0,0"
                      VerticalAlignment="Top"
                      Orientation="Vertical">
                      <Ribbon:RadioButton
                        x:Name="rbDaily"
                        Click="rbCheckInterval_Click"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        GroupName="uasi"
                        Header="{DynamicResource chkEveryday}" />
                      <Ribbon:RadioButton
                        x:Name="rbWeekly"
                        Click="rbCheckInterval_Click"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        GroupName="uasi"
                        Header="{DynamicResource chkEveryweek}" />
                      <Ribbon:RadioButton
                        x:Name="rbMonthly"
                        Click="rbCheckInterval_Click"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        GroupName="uasi"
                        Header="{DynamicResource chkEverymonth}" />
                    </StackPanel>
                    <Ribbon:SeparatorTabItem
                      Margin="0,170,0,0"
                      VerticalAlignment="Top"
                      Header="{DynamicResource txtUpdateChannel}"
                      Style="{DynamicResource InnerBackstageSeparatorTabItemStyle}" />
                    <Ribbon:RadioButton
                      x:Name="rbReleases"
                      Margin="5,200,0,0"
                      VerticalAlignment="Top"
                      Click="UpdateTypeCheck_Click"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      GroupName="uach"
                      Header="{DynamicResource chkReleasesChannel}" />
                    <Ribbon:RadioButton
                      x:Name="rbReleasTest"
                      Margin="5,220,0,0"
                      VerticalAlignment="Top"
                      Click="UpdateTypeCheck_Click"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      GroupName="uach"
                      Header="{DynamicResource chkDevChannel}" />
                    <TextBlock
                      Height="30"
                      Margin="15,240,0,0"
                      HorizontalAlignment="Left"
                      VerticalAlignment="Top"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Text="{DynamicResource txtTestBuildWarning}" />
                    <Expander
                      Width="250"
                      Margin="5,270,0,0"
                      HorizontalAlignment="Left"
                      VerticalAlignment="Top"
                      Header="{DynamicResource txtAdvancedUpdateSettings}"
                      Visibility="Collapsed">
                      <Grid>
                        <TextBlock
                          Margin="12,12,0,0"
                          HorizontalAlignment="Left"
                          VerticalAlignment="Top"
                          Text="{DynamicResource txtUpdateURL}" />
                        <TextBox
                          x:Name="updURL"
                          Height="23"
                          Margin="12,34,12,0"
                          VerticalAlignment="Top" />
                      </Grid>
                    </Expander>
                  </Grid>
                </TabItem>
                <Ribbon:SeparatorTabItem Header="{DynamicResource sepShortcutsCP}" />
                <TabItem HorizontalContentAlignment="Left"
                         Ribbon:KeyTip.Keys="R"
                         Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                         Header="{DynamicResource tabNavigationCP}">
                  <Grid Margin="20,5,0,0">
                    <Grid.RowDefinitions>
                      <RowDefinition Height="Auto" />
                      <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <Ribbon:CheckBox
                      x:Name="chkLevelUpEmpty"
                      Checked="chkLevelUpEmpty_CheckChanged"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Header="{DynamicResource chkUpLevelEmptyCP}"
                      Unchecked="chkLevelUpEmpty_CheckChanged" />
                  </Grid>
                </TabItem>
                <Ribbon:SeparatorTabItem Header="{DynamicResource sepAppearanceCP}" />
                <TabItem
                  HorizontalContentAlignment="Left"
                  Ribbon:KeyTip.Keys="R"
                  Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                  Header="{DynamicResource tabRibbonCP}">
                  <Grid Margin="20,5,0,0">
                    <Grid.RowDefinitions>
                      <RowDefinition Height="Auto" />
                      <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <Ribbon:SeparatorTabItem
                      VerticalAlignment="Top"
                      Header="{DynamicResource sepRibbonColorCP}"
                      Style="{DynamicResource InnerBackstageSeparatorTabItemStyle}" />
                    <StackPanel
                      Height="60"
                      Margin="6,20,0,0"
                      HorizontalAlignment="Left"
                      VerticalAlignment="Top"
                      Orientation="Horizontal">
                      <toggleswitch:HorizontalToggleSwitch
                        x:Name="btnTheme"
                        Grid.Row="1"
                        Margin="0,20,0,0"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Top"
                        Checked="BtnTheme_OnChecked"
                        CheckedContent="Dark"
                        CheckedForeground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        Style="{StaticResource SafariSwitchStyle}"
                        Unchecked="BtnTheme_OnUnchecked"
                        UncheckedContent="Light"
                        UncheckedForeground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}" />
                    </StackPanel>
                    <Ribbon:SeparatorTabItem
                      Margin="0,100,0,0"
                      VerticalAlignment="Top"
                      Header="{DynamicResource sepContextualTabsCP}"
                      Style="{DynamicResource InnerBackstageSeparatorTabItemStyle}" />
                    <TextBlock
                      Margin="10,135,0,0"
                      HorizontalAlignment="Left"
                      VerticalAlignment="Top"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Text="{DynamicResource lblAutoSwitchCP}" />
                    <StackPanel
                      Height="150"
                      Margin="6,150,0,0"
                      HorizontalAlignment="Left"
                      VerticalAlignment="Top"
                      Orientation="Vertical">
                      <Ribbon:CheckBox
                        x:Name="chkFolder"
                        Checked="chkFolder_CheckChanged"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        Header="{DynamicResource ctgFolderToolsCP}"
                        Unchecked="chkFolder_CheckChanged" />
                      <Ribbon:CheckBox
                        x:Name="chkDrive"
                        Checked="chkDrive_CheckChanged"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        Header="{DynamicResource ctbDriveToolsCP}"
                        Unchecked="chkDrive_CheckChanged" />
                      <Ribbon:CheckBox
                        x:Name="chkArchive"
                        Checked="chkArchive_CheckChanged"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        Header="{DynamicResource ctbArchiveToolsCP}"
                        Unchecked="chkArchive_CheckChanged" />
                      <Ribbon:CheckBox
                        x:Name="chkApp"
                        Checked="chkApp_CheckChanged"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        Header="{DynamicResource ctbApplicationsCP}"
                        Unchecked="chkApp_CheckChanged" />
                      <Ribbon:CheckBox
                        x:Name="chkImage"
                        Checked="chkImage_CheckChanged"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        Header="{DynamicResource ctbImageToolsCP}"
                        Unchecked="chkImage_CheckChanged" />
                      <Ribbon:CheckBox
                        x:Name="chkLibrary"
                        Checked="chkLibrary_CheckChanged"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        Header="{DynamicResource ctbLibrariesCP}"
                        Unchecked="chkLibrary_CheckChanged" />
                      <Ribbon:CheckBox
                        x:Name="chkVirtualTools"
                        Checked="chkVirtualTools_CheckChanged"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        Header="Virtual Disk Tools"
                        Unchecked="chkVirtualTools_CheckChanged" />
                    </StackPanel>
                    <Ribbon:SeparatorTabItem
                      Margin="0,300,0,0"
                      VerticalAlignment="Top"
                      Header="Visual Settings"
                      Style="{DynamicResource InnerBackstageSeparatorTabItemStyle}" />
                    <Ribbon:CheckBox
                      x:Name="chkRibbonMinimizedGlass"
                      Margin="6,330,0,0"
                      HorizontalAlignment="Left"
                      VerticalAlignment="Top"
                      Click="chkRibbonMinimizedGlass_Click"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Header="Enable glass when ribbon is minimized." />
                  </Grid>
                </TabItem>
                <TabItem
                  HorizontalContentAlignment="Left"
                  Ribbon:KeyTip.Keys="P"
                  Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                  Header="{DynamicResource tabPanesItemsCP}">
                  <Grid Margin="20,5,0,0">
                    <StackPanel
                      HorizontalAlignment="Stretch"
                      VerticalAlignment="Stretch"
                      Orientation="Vertical">
                      <Ribbon:SeparatorTabItem Margin="0,0,0,5" Header="{DynamicResource btnNavigationCP}" />
                      <StackPanel Orientation="Horizontal">
                        <Ribbon:CheckBox
                          x:Name="chkTreeExpand"
                          Ribbon:KeyTip.Keys="T"
                          Checked="chkTreeExpand_CheckChanged"
                          Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                          Header="{DynamicResource chkTreeExpandCP}"
                          IsEnabled="False"
                          Unchecked="chkTreeExpand_CheckChanged">
                          <Ribbon:CheckBox.ToolTip>
                            <Ribbon:ScreenTip
                              Title="{DynamicResource chkTreeExpandTCP}"
                              Width="250"
                              Image="Images\uac48.png"
                              IsRibbonAligned="false"
                              Text="{DynamicResource chkTreeExpandTTX}" />
                          </Ribbon:CheckBox.ToolTip>
                        </Ribbon:CheckBox>
                        <Image Source="Images\uac16.png" />
                      </StackPanel>
                      <Ribbon:SeparatorTabItem
                        Margin="0,0,0,5"
                        Header="{DynamicResource sepOptionalCP}"
                        Visibility="Collapsed" />
                      <Ribbon:CheckBox
                        x:Name="chkIsFlyout"
                        Margin="0,0,0,10"
                        Ribbon:KeyTip.Keys="H"
                        Checked="chkIsFlyout_CheckChanged"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        Header="{DynamicResource chkIsFlyout}"
                        Unchecked="chkIsFlyout_CheckChanged"
                        Visibility="Collapsed">
                        <Ribbon:CheckBox.ToolTip>
                          <Ribbon:ScreenTip
                            Title="Show Hover Flyout"
                            Width="250"
                            IsRibbonAligned="false"
                            Text="{DynamicResource chkIsFlyout_Tooltip}" />
                        </Ribbon:CheckBox.ToolTip>
                      </Ribbon:CheckBox>
                      <Ribbon:SeparatorTabItem Margin="0,0,0,5" Header="{DynamicResource txtImageEditing}" />
                      <Ribbon:CheckBox
                        x:Name="chkOverwriteImages"
                        Margin="0,0,0,10"
                        Ribbon:KeyTip.Keys="V"
                        Checked="chkOverwriteImages_Checked"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        Header="{DynamicResource chkEditOverwrite}"
                        Unchecked="chkOverwriteImages_Checked">
                        <Ribbon:CheckBox.ToolTip>
                          <Ribbon:ScreenTip
                            Title="{DynamicResource chkEditOverwrite}"
                            Width="250"
                            IsRibbonAligned="false"
                            Text="{DynamicResource chkEditOverwrite_Text}" />
                        </Ribbon:CheckBox.ToolTip>
                      </Ribbon:CheckBox>
                      <Ribbon:SeparatorTabItem Margin="0,0,0,5" Header="Item Label Colorizing" />
                      <DataGrid
                        x:Name="grdItemTextColor"
                        Height="150"
                        HorizontalAlignment="Stretch"
                        AutoGenerateColumns="False"
                        CanUserAddRows="True"
                        ItemsSource="{Binding Path=LVItemsColorCol}">
                        <DataGrid.Columns>
                          <DataGridTextColumn
                            Width="*"
                            Binding="{Binding ExtensionList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                            Header="Extensions" />
                          <DataGridTemplateColumn Width="100" Header="Color">
                            <DataGridTemplateColumn.CellTemplate>
                              <DataTemplate>
                                <toolkit:ColorPicker SelectedColor="{Binding TextColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                              </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                          </DataGridTemplateColumn>
                        </DataGrid.Columns>
                      </DataGrid>
                      <Ribbon:SeparatorTabItem Margin="0,0,0,5" Header="Folder Settings" />
                      <Border
                        Margin="5,5,0,0"
                        HorizontalAlignment="Left"
                        BorderBrush="DarkGray"
                        BorderThickness="1"
                        CornerRadius="2">
                        <Ribbon:Button
                          x:Name="btnResetFolderSettings"
                          Height="22"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          Ribbon:KeyTip.Keys="RFS"
                          Click="btnResetFolderSettings_OnClick"
                          CornerRadius="2"
                          Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                          Header="Reset DB"
                          Icon="Images\open16.png"
                          IsDefinitive="True"
                          SizeDefinition="Middle,Middle,Middle" />
                      </Border>
                    </StackPanel>
                  </Grid>
                </TabItem>
                <TabItem
                  HorizontalContentAlignment="Left"
                  Ribbon:KeyTip.Keys="T"
                  Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                  Header="{DynamicResource tabTabsCP}">
                  <Grid Margin="20,5,0,0">
                    <Ribbon:SeparatorTabItem
                      VerticalAlignment="Top"
                      Header="{DynamicResource sepAlignmentCP}"
                      Style="{DynamicResource InnerBackstageSeparatorTabItemStyle}" />
                    <StackPanel Margin="0,35,0,0" Orientation="Vertical">
                      <TextBlock Text="{DynamicResource lblShowTabBarCP}" />
                      <Ribbon:RadioButton
                        x:Name="TabbaTop"
                        Margin="5,5,0,0"
                        Ribbon:KeyTip.Keys="TT"
                        Checked="FolderTabs_Placement"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        GroupName="tba"
                        Header="{DynamicResource chkTabBarTopCP}" />
                      <Ribbon:RadioButton
                        x:Name="TabbaBottom"
                        Margin="5,5,0,0"
                        Ribbon:KeyTip.Keys="TB"
                        Checked="FolderTabs_Placement"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        GroupName="tba"
                        Header="{DynamicResource chkTabBarBottomCP}" />
                    </StackPanel>
                    <Ribbon:SeparatorTabItem
                      Margin="0,100,0,0"
                      VerticalAlignment="Top"
                      Header="{DynamicResource sepSavedTabsCP}"
                      Style="{DynamicResource InnerBackstageSeparatorTabItemStyle}" />
                    <Border
                      Margin="5,135,0,0"
                      HorizontalAlignment="Left"
                      VerticalAlignment="Top"
                      BorderBrush="#FF000000"
                      BorderThickness="1">
                      <Ribbon:Button
                        x:Name="btnShowTabManager"
                        Width="Auto"
                        Height="22"
                        Margin="0"
                        Padding="5,0,5,0"
                        HorizontalAlignment="Left"
                        Ribbon:KeyTip.Keys="T"
                        BorderBrush="Black"
                        BorderThickness="1"
                        Click="miTabManager_Click"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        Header="{DynamicResource btnShowTabManagerCP}"
                        Icon="Images\open16.png" />
                    </Border>
                    <TextBlock
                      Margin="5,165,0,0"
                      HorizontalAlignment="Left"
                      VerticalAlignment="Top"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Text="{DynamicResource lblDefSavedTabsLocCP}"
                      Visibility="Collapsed" />
                    <StackPanel
                      Margin="5,180,0,0"
                      HorizontalAlignment="Left"
                      VerticalAlignment="Top"
                      Orientation="Horizontal">
                      <Ribbon:TextBox
                        x:Name="txtDefSaveTabs"
                        Width="450"
                        Header="{DynamicResource lblDefSavedTabsLocCP}"
                        IsReadOnly="True" />
                      <Ribbon:Button
                        x:Name="btnChangeTabsFolder"
                        Width="Auto"
                        Height="22"
                        Padding="5,0,5,0"
                        Ribbon:KeyTip.Keys="T"
                        BorderBrush="Black"
                        BorderThickness="1"
                        Click="btnChangeTabsFolder_Click"
                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                        Header="{DynamicResource txtBrowse}"
                        Icon="Images\browsefldr16.png" />
                    </StackPanel>
                    <TextBlock
                      Margin="10,210,0,0"
                      HorizontalAlignment="Left"
                      VerticalAlignment="Top"
                      Foreground="{DynamicResource Fluent.Ribbon.Brushes.LabelTextBrush}"
                      Text="{DynamicResource lblSavedTabsWarningCP}" />
                    <Ribbon:SeparatorTabItem
                      Margin="0,240,0,0"
                      VerticalAlignment="Top"
                      Header="Actions"
                      Style="{DynamicResource InnerBackstageSeparatorTabItemStyle}" />

                    <!--
                  <Ribbon:CheckBox x:Name="chkIsLastTabCloseApp"
                   Height="22"
                   Margin="7,275,0,0"
                   VerticalAlignment="Top"
                   Click="chkIsLastTabCloseApp_Click"
                   Header="Closing last Tab closes Application" />
                  -->

                  </Grid>
                </TabItem>
                <!--
          <TabItem Header="Accounts"
          Ribbon:KeyTip.Keys="F">
          <Grid Margin="20,5,0,0">
          <Ribbon:SeparatorTabItem VerticalAlignment="Top" Margin="0,0,0,0"
          Header="Connected Accounts/Locations"
          Style="{DynamicResource InnerBackstageSeparatorTabItemStyle}" />
          <Ribbon:Button x:Name="btnAddWebServer"
          Height="88"
          Margin="0,35,0,0"
          HorizontalAlignment="Left"
          VerticalAlignment="Top"
          Header="Add Server"
          Icon="Images\add16.png"
          IsDefinitive="True"
          LargeIcon="Images\add32.png"
          Ribbon:KeyTip.Keys="A"
          Ribbon:KeyTip.AutoPlacement="False"
          Ribbon:KeyTip.VerticalAlignment="Bottom"
          Ribbon:KeyTip.HorizontalAlignment="Center"
          Style="{DynamicResource ButtonBackstageStyle}" Click="btnAddWebServer_Click">
          </Ribbon:Button>
          <Ribbon:Button x:Name="btnAddStorageService"
          Height="88"
          Margin="100,35,0,0"
          HorizontalAlignment="Left"
          VerticalAlignment="Top"
          Header="Add Account"
          Icon="Images\add16.png"
          IsDefinitive="True"
          LargeIcon="Images\add32.png"
          Ribbon:KeyTip.Keys="A"
          Ribbon:KeyTip.AutoPlacement="False"
          Ribbon:KeyTip.VerticalAlignment="Bottom"
          Ribbon:KeyTip.HorizontalAlignment="Center"
          Style="{DynamicResource ButtonBackstageStyle}" Click="btnAddStorageService_Click" >
          </Ribbon:Button>
          <ScrollViewer Margin="20,135,20,20" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" VerticalScrollBarVisibility="Auto">
          <StackPanel x:Name="pnlServers">
          
          </StackPanel>
          </ScrollViewer>
          </Grid>
          </TabItem>
        -->
              </TabControl>
            </Ribbon:BackstageTabItem>
            <Ribbon:Button Header="Show Notif Test" Click="ButtonBase_OnClick">

            </Ribbon:Button>
            <Ribbon:Button
              x:Name="Exitbutton"
              Ribbon:KeyTip.Keys="X"
              Click="btnBackstageExit_Click"
              Content="Exit"
              Header="{DynamicResource btnExitCP}"
              Icon="Images\exit16.png"
              LargeIcon="Images\exit32.png" />
          </Ribbon:BackstageTabControl>
        </Ribbon:Backstage>
      </Ribbon:Ribbon.Menu>
      <Ribbon:Ribbon.ContextualGroups>
        <Ribbon:RibbonContextualTabGroup
          x:Name="ctgLibraries"
          MinWidth="120"
          Background="Purple"
          BorderBrush="Magenta"
          Header="{DynamicResource ctbLibrariesCP}"
          Visibility="Collapsed" />
        <Ribbon:RibbonContextualTabGroup
          x:Name="ctgDrive"
          MinWidth="100"
          Background="LightBlue"
          BorderBrush="Blue"
          Header="{DynamicResource ctbDriveToolsCP}"
          Visibility="Collapsed" />
        <Ribbon:RibbonContextualTabGroup
          x:Name="ctgExe"
          MinWidth="100"
          Background="Red"
          BorderBrush="DarkRed"
          Header="{DynamicResource ctbApplicationsCP}"
          Visibility="Collapsed" />
        <Ribbon:RibbonContextualTabGroup
          x:Name="ctgVirtualDisk"
          MinWidth="100"
          Background="Coral"
          BorderBrush="Coral"
          Header="Virtual Disk Tools"
          Visibility="Collapsed" />
        <Ribbon:RibbonContextualTabGroup
          x:Name="ctgImage"
          MinWidth="100"
          Background="Orange"
          BorderBrush="DarkOrange"
          Header="{DynamicResource ctbImageToolsCP}"
          Visibility="Collapsed" />
        <Ribbon:RibbonContextualTabGroup
          x:Name="ctgArchive"
          MinWidth="100"
          Background="SlateBlue"
          BorderBrush="DarkSlateBlue"
          Header="{DynamicResource ctbArchiveToolsCP}"
          Visibility="Collapsed" />
        <Ribbon:RibbonContextualTabGroup
          x:Name="ctgFolderTools"
          MinWidth="110"
          Background="Goldenrod"
          BorderBrush="Peru"
          Header="{DynamicResource ctgFolderToolsCP}"
          Visibility="Collapsed" />
        <Ribbon:RibbonContextualTabGroup
          x:Name="ctgSearch"
          MinWidth="100"
          Background="Green"
          BorderBrush="DarkGreen"
          Header="{DynamicResource ctbSearchToolsCP}"
          Visibility="Collapsed" />
        <!--  IsVisibleChanged="ctgSearch_IsVisibleChanged"  -->
      </Ribbon:Ribbon.ContextualGroups>

      <Ribbon:RibbonTabItem
        x:Name="HomeTab"
        Ribbon:KeyTip.Keys="H"
        Header="{DynamicResource tbHomeCP}"
        Indent="7"
        ReduceOrder="Clipboard,Organize,Open,Tabs,Select,Select,Select,grpBadges,Organize,Open,Organize,Clipboard,Tabs,Open,Tabs">
        <Ribbon:RibbonGroupBox x:Name="Clipboard" Header="{DynamicResource tgClipboardCP}">
          <Ribbon:Button
            x:Name="btnCopy"
            Ribbon:KeyTip.Keys="CO"
            CanAddToQuickAccessToolBar="True"
            Click="btnCopy_Click"
            Header="{DynamicResource btnCopyCP}"
            Icon="Images\Copy16.png"
            IsEnabled="False"
            LargeIcon="Images\Copy32.png">
            <Ribbon:Button.ToolTip>
              <Ribbon:ScreenTip
                Title="{DynamicResource btnCopyTCP}"
                Width="250"
                Image="Images\Copy48.png"
                IsRibbonAligned="True"
                Text="{DynamicResource btnCopyTTX}" />
            </Ribbon:Button.ToolTip>
            <!--  "{DynamicResource btnCopyTCP}"  -->
          </Ribbon:Button>
          <Ribbon:Button
            x:Name="btnPaste"
            Ribbon:KeyTip.Keys="P"
            Click="btnPaste_Click"
            Header="{DynamicResource btnPasteCP}"
            Icon="Images\paste16.png"
            IsEnabled="False"
            LargeIcon="Images\paste32.png">
            <Ribbon:Button.ToolTip>
              <Ribbon:ScreenTip
                Title="{DynamicResource btnPasteTCP}"
                Width="250"
                Image="Images\paste48.png"
                IsRibbonAligned="True"
                Text="{DynamicResource btnPasteTTX}" />
            </Ribbon:Button.ToolTip>
            <!--  "{DynamicResource btnPasteTCP}"  -->
          </Ribbon:Button>
          <Ribbon:Button
            x:Name="btnCut"
            Ribbon:KeyTip.Keys="CU"
            Click="btnCut_Click"
            Header="{DynamicResource btnCutCP}"
            Icon="Images\cut16.png"
            IsEnabled="False"
            SizeDefinition="Middle,Middle,Small" />
          <Ribbon:Button
            x:Name="btnPathCopy"
            Ribbon:KeyTip.Keys="CP"
            Click="btnPathCopy_Click"
            Header="{DynamicResource btnCopyPathCP}"
            Icon="Images\copypath16.png"
            IsEnabled="True"
            SizeDefinition="Middle,Small,Small">
            <Ribbon:Button.ToolTip>
              <Ribbon:ScreenTip
                Title="{DynamicResource btnCopyPathCP}"
                Width="250"
                Image="Images\copypath32.png"
                IsRibbonAligned="True"
                Text="{DynamicResource btnCopyPTTX}" />
            </Ribbon:Button.ToolTip>
          </Ribbon:Button>
          <Ribbon:SplitButton
            x:Name="btnPasetShC"
            Ribbon:KeyTip.Keys="SP"
            Click="btnPasetShC_Click"
            Header="{DynamicResource btnPasteScCP}"
            Icon="Images\pastet16.png"
            IsEnabled="False"
            SizeDefinition="Middle,Small,Small">
            <Ribbon:MenuItem
              Click="btnPasetShC_Click"
              Focusable="False"
              Header="{DynamicResource btnPasteScCP}"
              Icon="Images\pastet16.png" />
            <Ribbon:MenuItem
              x:Name="miCreateSymlink"
              Click="miCreateSymlink_Click"
              Focusable="False"
              Header="Create symbolic link" />
            <Ribbon:MenuItem
              x:Name="miJunctionpoint"
              Click="miJunctionpoint_Click"
              Focusable="False"
              Header="Create Junction Point" />
          </Ribbon:SplitButton>
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox
          x:Name="Organize"
          Ribbon:KeyTip.Keys="OR"
          Header="{DynamicResource tgOrganizeCP}">
          <Ribbon:SplitButton
            x:Name="btnCopyto"
            Ribbon:KeyTip.Keys="CF"
            Click="btnCopyto_Click"
            Header="{DynamicResource btnCopyToCP}"
            Icon="Images\copyto16.png"
            IsEnabled="False"
            LargeIcon="Images\copyto32.png">
            <MenuItem
              x:Name="btnctDocuments"
              Ribbon:KeyTip.Keys="DO"
              Click="btnctDocuments_Click"
              Focusable="False"
              Header="{DynamicResource btnctDocumentsCP}" />
            <MenuItem
              x:Name="btnctDesktop"
              Ribbon:KeyTip.Keys="DE"
              Click="btnctDesktop_Click"
              Focusable="False"
              Header="{DynamicResource btnctDesktopCP}" />
            <MenuItem
              x:Name="btnctDounloads"
              Ribbon:KeyTip.Keys="DN"
              Click="btnctDounloads_Click"
              Focusable="False"
              Header="{DynamicResource btnctDownloadsCP}" />
            <Separator Focusable="False" />
            <MenuItem
              x:Name="btnctOther"
              Ribbon:KeyTip.Keys="O"
              Click="btnctOther_Click"
              Focusable="False"
              Header="{DynamicResource miOtherDestCP}" />
          </Ribbon:SplitButton>
          <Ribbon:SplitButton
            x:Name="btnMoveto"
            Ribbon:KeyTip.Keys="M"
            Click="btnMoveto_Click"
            Header="{DynamicResource btnMoveToCP}"
            Icon="Images\moveto16.png"
            IsEnabled="False"
            LargeIcon="Images\moveto32.png">
            <MenuItem
              x:Name="btnmtDocuments"
              Ribbon:KeyTip.Keys="DO"
              Click="btnmtDocuments_Click"
              Focusable="False"
              Header="{DynamicResource btnctDocumentsCP}" />
            <MenuItem
              x:Name="btnmtDesktop"
              Ribbon:KeyTip.Keys="DE"
              Click="btnmtDesktop_Click"
              Focusable="False"
              Header="{DynamicResource btnctDesktopCP}" />
            <MenuItem
              x:Name="btnmtDounloads"
              Ribbon:KeyTip.Keys="DN"
              Click="btnmtDounloads_Click"
              Focusable="False"
              Header="{DynamicResource btnctDownloadsCP}" />
            <Separator />
            <MenuItem
              x:Name="btnmtOther"
              Ribbon:KeyTip.Keys="O"
              Click="btnmtOther_Click"
              Header="{DynamicResource miOtherDestCP}" />
          </Ribbon:SplitButton>
          <Separator />
          <Ribbon:SplitButton
            x:Name="btnDelete"
            Ribbon:KeyTip.Keys="D"
            Click="btnDelete_Click"
            Header="{DynamicResource btnDeleteCP}"
            Icon="Images\delete16.png"
            IsEnabled="False"
            LargeIcon="Images\delete32.png">
            <MenuItem
              Ribbon:KeyTip.Keys="R"
              Click="MenuItem_Click"
              Focusable="False"
              Header="{DynamicResource miDeltoRB}"
              Icon="Images\delrb16.png" />
            <MenuItem
              Ribbon:KeyTip.Keys="P"
              Click="MenuItem_Click_1"
              Focusable="False"
              Header="{DynamicResource miDeltoP}"
              Icon="Images\delete16.png" />
          </Ribbon:SplitButton>
          <Ribbon:Button
            x:Name="btnRename"
            Ribbon:KeyTip.Keys="R"
            Click="btnRename_Click"
            Focusable="False"
            Header="{DynamicResource btnRenameCP}"
            Icon="Images\rename16.png"
            IsEnabled="False"
            LargeIcon="Images\rename32.png" />
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox
          x:Name="New"
          Ribbon:KeyTip.Keys="NG"
          Header="{DynamicResource tgNewCP}">
          <Ribbon:Button
            x:Name="btnCreateFolder"
            Ribbon:KeyTip.Keys="N"
            Click="btnNewFolder_Library"
            Focusable="False"
            Header="{DynamicResource btnNewFolderCP}"
            Icon="Images\folder_new16.png"
            LargeIcon="Images\folder_new32.png"
            SizeDefinition="Large"
            TextOptions.TextFormattingMode="Display">
            <Ribbon:Button.ToolTip>
              <Ribbon:ScreenTip
                x:Name="stNewFolder"
                Title="New Folder"
                Width="250"
                Image="Images\folder_new32.png"
                IsRibbonAligned="True"
                Text="{DynamicResource stNewFolder}" />
            </Ribbon:Button.ToolTip>
          </Ribbon:Button>
          <Ribbon:DropDownButton
            x:Name="btnNewItem"
            Ribbon:KeyTip.Keys="CR"
            DropDownOpened="btnNewItem_DropDownOpened"
            Header="New item"
            Icon="Images\newitems16.png"
            SizeDefinition="Middle,Small,Small"
            Visibility="Visible" />
          <Ribbon:DropDownButton
            x:Name="btnEasyAccess"
            Ribbon:KeyTip.Keys="E"
            DropDownOpened="btnEasyAccess_DropDownOpened"
            Focusable="False"
            Header="Easy Access"
            Icon="Images\easyacc16.png"
            SizeDefinition="Middle,Small,Small"
            Visibility="Visible">
            <Ribbon:MenuItem
              x:Name="mnuPinToStart"
              Click="mnuPinToStart_Click"
              Header="{DynamicResource mnuPinToStart}" />
            <Ribbon:MenuItem
              x:Name="mnuIncludeInLibrary"
              Header="Include in library"
              Icon="Images\explorer16.png"
              IsEnabled="False">
              <Ribbon:MenuItem Header="{DynamicResource Create_New_Library}" Icon="Images\newlib16.png" />
            </Ribbon:MenuItem>
            <Ribbon:MenuItem
              x:Name="mnuAddFavorites"
              Click="btnFavorites_Click"
              Header="Add to Favorites"
              Icon="Images\favorites16.png" />
          </Ribbon:DropDownButton>
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox
          x:Name="Open"
          Ribbon:KeyTip.Keys="OP"
          Header="{DynamicResource tgOpenCP}">
          <!--  Properties button until functionality is added to "Clear Properties" button  -->
          <Ribbon:Button
            x:Name="btnProperties3"
            Ribbon:KeyTip.Keys="I"
            Click="btnProperties_Click"
            Header="{DynamicResource btnPropertiesCP}"
            Icon="Images\prop16.png"
            LargeIcon="Images\prop32.png"
            Visibility="Visible" />
          <!--  This is the original properties button, hidden because the "Clear Properties" button does nothing right now  -->
          <!--
      <Ribbon:SplitButton Header="{DynamicResource btnPropertiesCP}" Ribbon:KeyTip.Keys="PR" LargeIcon="Images\prop32.png" Icon="Images\prop16.png" Name="btnProperties" Click="btnProperties_Click" Visibility="Collapsed" DropDownOpened="btnMoreColls_DropDownOpened" DropDownClosed="btnMoreColls_DropDownClosed">
      <Ribbon:MenuItem Header="{DynamicResource btnPropertiesCP}" Name="btnProperties2" Click="btnProperties_Click" Ribbon:KeyTip.Keys="PD"/>
      <Separator/>
      <Ribbon:MenuItem Header="Clear Properties" Ribbon:KeyTip.Keys="CP"/>
      </Ribbon:SplitButton>
      -->
          <Ribbon:SplitButton
            x:Name="btnOpenWith"
            Ribbon:KeyTip.Keys="O"
            Click="btnOpenWith_Click"
            DropDownOpened="btnOpenWith_DropDownOpened"
            Header="{DynamicResource btnOpenCP}"
            Icon="Images\open16.png"
            IsEnabled="True"
            SizeDefinition="Middle,Middle,Small" />
          <Ribbon:Button
            x:Name="btnEdit"
            Ribbon:KeyTip.Keys="E"
            Click="btnEdit_Click"
            Header="{DynamicResource btnEditCP}"
            Icon="Images\edit16.png"
            IsEnabled="False"
            SizeDefinition="Middle,Middle,Small" />
          <Ribbon:Button
            x:Name="btnHistory"
            Ribbon:KeyTip.Keys="H"
            Click="btnHistory_Click"
            Header="{DynamicResource btnHistoryCP}"
            Icon="Images\history16.png"
            IsEnabled="False"
            SizeDefinition="Middle,Middle,Middle" />
          <Ribbon:SplitButton
            x:Name="btnFavorites"
            Ribbon:KeyTip.Keys="F"
            Click="btnFavorites_Click"
            Header="{DynamicResource btnFavoritesCP}"
            Icon="Images\favorites16.png"
            LargeIcon="Images\favorites32.png"
            SizeDefinition="Large, Middle, Middle" />
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox
          x:Name="Select"
          Ribbon:KeyTip.Keys="SE"
          Header="{DynamicResource tgSelectCP}">
          <!--  DropDownOpened="btnMoreColls_DropDownOpened" DropDownClosed="btnMoreColls_DropDownClosed">  -->
          <Ribbon:Button
            x:Name="btnSelAll"
            Ribbon:KeyTip.Keys="SA"
            Click="btnSelAll_Click"
            Header="{DynamicResource btnSelectAllCP}"
            Icon="Images\selectall16.png"
            SizeDefinition="Middle,Middle,Middle" />
          <Ribbon:Button
            x:Name="btnSelNone"
            Ribbon:KeyTip.Keys="SN"
            Click="btnSelNone_Click"
            Header="{DynamicResource btnSelectNoneCP}"
            Icon="Images\selectnone16.png"
            IsEnabled="False"
            SizeDefinition="Middle,Middle,Middle" />
          <Ribbon:Button
            x:Name="btnInvSel"
            Ribbon:KeyTip.Keys="SI"
            Click="btnInvSel_Click"
            Header="{DynamicResource btnInvertSelectionCP}"
            Icon="Images\invsel16.png"
            IsEnabled="True"
            SizeDefinition="Middle,Middle,Middle" />
          <Ribbon:SplitButton
            x:Name="btnCondSel"
            Ribbon:KeyTip.Keys="SC"
            Click="btnCondSel_Click"
            Header="{DynamicResource btnConditionalSelectCP}"
            Icon="Images\filter16.png"
            LargeIcon="Images\filter32.png"
            SizeDefinition="Large, Small, Small"
            Visibility="Visible">
            <Ribbon:SplitButton.ToolTip>
              <Ribbon:ScreenTip
                Title="{DynamicResource btnConditionalSelectCP}"
                Width="250"
                Image="Images\filter48.png"
                IsRibbonAligned="True"
                Text="{DynamicResource btnConditionalSelectCP_Text}" />
            </Ribbon:SplitButton.ToolTip>
            <MenuItem
              x:Name="miSelAllByType"
              Ribbon:KeyTip.Keys="T"
              Click="miSelAllByType_Click"
              Focusable="False"
              Header="{DynamicResource miSelAllByTypeCP}" />
            <MenuItem
              x:Name="miSelAllByDate"
              Ribbon:KeyTip.Keys="D"
              Click="miSelAllByDate_Click"
              Focusable="False"
              Header="{DynamicResource miSelAllByDateCP}" />
            <Separator />
            <MenuItem
              x:Name="miCondSelect"
              Ribbon:KeyTip.Keys="W"
              Click="btnCondSel_Click"
              Focusable="False"
              Header="{DynamicResource miCondSelectCP}"
              Icon="Images\filter16.png" />
          </Ribbon:SplitButton>
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox x:Name="grpBadges" Header="Badges">
          <Ribbon:DropDownButton
            x:Name="btnBadges"
            Ribbon:KeyTip.Keys="BA"
            Header="Badges"
            Icon="Images\Badge16.png"
            IsEnabled="true"
            LargeIcon="Images\Badge32.png"
            SizeDefinition="Large,Middle,Middle">
            <ItemsControl Margin="5" ItemsSource="{Binding Badges, RelativeSource={RelativeSource AncestorType={x:Type local:MainWindow}}}">
              <ItemsControl.ItemTemplate>
                <DataTemplate>
                  <Grid>
                    <Grid.RowDefinitions>
                      <RowDefinition Height="Auto" />
                      <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <Border
                      Grid.Row="0"
                      Margin="0,0,0,5"
                      VerticalAlignment="Center"
                      BorderBrush="DarkGray"
                      BorderThickness="0,0,0,1">
                      <ContentControl Content="{Binding Key}" />
                    </Border>
                    <ItemsControl
                      Grid.Row="1"
                      MaxWidth="300"
                      ItemsSource="{Binding Value}">
                      <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                          <WrapPanel IsItemsHost="True" />
                        </ItemsPanelTemplate>
                      </ItemsControl.ItemsPanel>
                      <ItemsControl.ItemTemplate>
                        <DataTemplate>
                          <Grid Width="26" Height="26">
                            <Border>
                              <Border.Style>
                                <Style>
                                  <Setter Property="Border.CornerRadius" Value="1" />
                                  <Setter Property="Border.Background" Value="Transparent" />
                                  <Style.Triggers>
                                    <Trigger Property="Border.IsMouseOver" Value="True">
                                      <Setter Property="Border.Background" Value="LightGray" />
                                    </Trigger>
                                  </Style.Triggers>
                                </Style>
                              </Border.Style>
                              <Image
                                Margin="3.5,0,2,4"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Bottom"
                                MouseLeftButtonUp="Image_MouseLeftButtonUp"
                                Source="{Binding Key.BitmapSource}"
                                Stretch="None"
                                Tag="{Binding Key}" />
                            </Border>
                          </Grid>
                        </DataTemplate>
                      </ItemsControl.ItemTemplate>
                    </ItemsControl>
                  </Grid>
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>
            <Ribbon:MenuItem Click="MenuItem_Click_2" Header="Clear Badge" />
          </Ribbon:DropDownButton>
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox
          x:Name="Tabs"
          Ribbon:KeyTip.Keys="T"
          Header="{DynamicResource tgTabsCP}">
          <Ribbon:Button
            x:Name="btnNewTab"
            Ribbon:KeyTip.Keys="T"
            Click="btnNewTab_Click"
            Header="{DynamicResource btnNewTabCP}"
            Icon="Images\newtab16.png"
            LargeIcon="Images\newtab32.png"
            SizeDefinition="Large,Middle,Middle">
            <Ribbon:Button.ToolTip>
              <!--  "{DynamicResource btnNewTabCP}"  -->
              <Ribbon:ScreenTip
                Title="{DynamicResource btnNewTabTCP}"
                Width="250"
                Image="Images\newtab32.png"
                IsRibbonAligned="True"
                Text="{DynamicResource btnNewTabTTX}" />
            </Ribbon:Button.ToolTip>
          </Ribbon:Button>
          <Ribbon:Button
            x:Name="btnTabCloseC"
            Ribbon:KeyTip.Keys="CT"
            Click="btnTabCloseC_Click"
            Header="{DynamicResource btnCloseTabCP}"
            Icon="Images\closetab.png"
            LargeIcon="Images\closetab.png"
            SizeDefinition="Large,Middle,Middle" />
          <Ribbon:Button
            x:Name="btnTabClone"
            Ribbon:KeyTip.Keys="CL"
            Click="btnTabClone_Click"
            ClickMode="Release"
            Header="{DynamicResource btnCloneTabCP}"
            Icon="Images\clonetab.png"
            IsDefault="False"
            IsDefinitive="True"
            LargeIcon="Images\clonetab.png"
            SizeDefinition="Middle,Middle,Middle">
            <Ribbon:Button.ToolTip>
              <!--  "{DynamicResource btnCloneTabTCP}"  -->
              <Ribbon:ScreenTip
                Title="{DynamicResource btnCloneTabCP}"
                Width="250"
                Image="Images\clonetab.png"
                IsRibbonAligned="True"
                Text="{DynamicResource btnCloneTabTTX}" />
            </Ribbon:Button.ToolTip>
          </Ribbon:Button>
          <Ribbon:DropDownButton
            x:Name="btnSavedTabs"
            Ribbon:KeyTip.Keys="R"
            DropDownOpened="btnSavedTabs_DropDownOpened"
            Header="{DynamicResource btnSavedTabsCP}"
            Icon="Images\savetabs16.png"
            LargeIcon="Images\savetabs32.png"
            SizeDefinition="Middle,Middle,Small">
            <Ribbon:DropDownButton.ToolTip>
              <Ribbon:ScreenTip
                Title="{DynamicResource btnSavedTabsCP}"
                Width="250"
                IsRibbonAligned="True"
                Text="{DynamicResource btnSavedTabsHCP}" />
            </Ribbon:DropDownButton.ToolTip>
            <!--  TODO: Add Saved Tabs gallery  -->
            <Ribbon:Gallery
              x:Name="stGallery"
              Orientation="Vertical"
              SelectionChanged="stGallery_SelectionChanged">
              <!--  Items added programmatically  -->
            </Ribbon:Gallery>
            <Ribbon:MenuItem
              x:Name="miSaveCurTabs"
              Ribbon:KeyTip.Keys="S"
              Click="miSaveCurTabs_Click"
              Focusable="False"
              Header="{DynamicResource miSaveTabs}"
              Icon="Images\savetabs16.png" />
            <Separator />
            <Ribbon:MenuItem
              x:Name="miTabManager"
              Ribbon:KeyTip.Keys="M"
              Click="miTabManager_Click"
              Focusable="False"
              Header="{DynamicResource sepSavedTabsCP}" />
          </Ribbon:DropDownButton>
          <Ribbon:SplitButton
            x:Name="btnUndoClose"
            Ribbon:KeyTip.Keys="UC"
            Click="btnUndoClose_Click"
            DropDownOpened="btnUndoClose_DropDownOpened"
            Header="{DynamicResource btnUndoCloseCP}"
            Icon="Images\undotab16.png"
            IsEnabled="False"
            LargeIcon="Images\undotab32.png"
            SizeDefinition="Middle,Middle,Small">
            <Ribbon:SplitButton.ToolTip>
              <Ribbon:ScreenTip
                Title="{DynamicResource btnUndoCloseCP}"
                Width="250"
                IsRibbonAligned="True"
                Text="{DynamicResource btnUndoCloseHCP}" />
            </Ribbon:SplitButton.ToolTip>
            <Ribbon:Gallery
              x:Name="rotGallery"
              Orientation="Vertical"
              SelectionChanged="rotGallery_SelectionChanged">
              <!--  Items added programmatically  -->
            </Ribbon:Gallery>
            <Ribbon:MenuItem
              x:Name="miClearUndoList"
              Ribbon:KeyTip.Keys="C"
              Click="miClearUndoList_Click"
              Focusable="False"
              Header="Clear List" />
          </Ribbon:SplitButton>
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox x:Name="RecycleBin" Header="Recycle Bin">
          <Ribbon:SplitButton
            x:Name="btnRecycleBin"
            Click="miOpenRB_Click"
            Header="Recycle Bin"
            Icon="Images/RecycleBinEmpty16.png"
            LargeIcon="Images/RecycleBinEmpty32.png"
            SizeDefinition="Large, Small, Small">
            <Ribbon:MenuItem
              x:Name="miEmptyRB"
              Click="miEmptyRB_Click"
              Header="{DynamicResource miEmptyRB}" />
            <Ribbon:MenuItem
              x:Name="miOpenRB"
              Click="miOpenRB_Click"
              Header="{DynamicResource miOpenRB}" />
            <Ribbon:MenuItem
              x:Name="miRestoreRBItems"
              Click="miRestoreRBItems_Click"
              Header="{DynamicResource miRestoreRBItems}" />
            <Ribbon:MenuItem
              x:Name="miRestoreALLRB"
              Click="miRestoreALLRB_Click"
              Header="{DynamicResource miRestoreALLRB}" />
          </Ribbon:SplitButton>
          <Ribbon:TwoLineLabel
            x:Name="lblRBItems"
            Margin="10,15,0,0"
            HasTwoLines="False"
            Text="0 Items" />
          <Ribbon:TwoLineLabel
            x:Name="lblRBSize"
            Margin="10,10,0,0"
            HasTwoLines="False"
            Text="0 bytes" />
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox
          x:Name="tmpGroupB"
          Header="Developer"
          Visibility="Collapsed">
          <Ribbon:Button
            x:Name="tmpButtonB"
            Click="tmpButtonB_Click"
            Header="{DynamicResource tmpButtonB}" />
        </Ribbon:RibbonGroupBox>
      </Ribbon:RibbonTabItem>
      <Ribbon:RibbonTabItem
        x:Name="tbShare"
        Ribbon:KeyTip.Keys="S"
        Header="{DynamicResource tbShareCP}"
        Indent="7"
        ReduceOrder="Network,Network,Compress,Compress,Compress,Network"
        Visibility="Visible">
        <Ribbon:RibbonGroupBox
          x:Name="Compress"
          Ribbon:KeyTip.Keys="C"
          Header="{DynamicResource tgCompressCP}"
          Visibility="Collapsed">
          <Ribbon:Button
            x:Name="btnCreateArchive"
            Ribbon:KeyTip.Keys="R"
            Click="btnCreateArchive_Click"
            Header="{DynamicResource btnMakeArchiveCP}"
            Icon="Images\archiver16.png"
            LargeIcon="Images\archiver32.png"
            SizeDefinition="Large,Large,Large">
            <Ribbon:Button.ToolTip>
              <!--  Title="{DynamicResource btnMakeArchiveHCP}"  -->
              <Ribbon:ScreenTip
                Title="{DynamicResource btnMakeArchiveCP}"
                Width="250"
                Image="Images\archiver32.png"
                IsRibbonAligned="True"
                Text="{DynamicResource btnMakeArchiveICP}" />
            </Ribbon:Button.ToolTip>
          </Ribbon:Button>
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox x:Name="Share" Ribbon:KeyTip.Keys="W">
          <Ribbon:Button
            x:Name="btnShare"
            Ribbon:KeyTip.Keys="S"
            Click="Button_Click_4"
            Header="{DynamicResource btnShareCP}"
            Icon="Images\Share16.png"
            IsEnabled="False"
            LargeIcon="Images\share32.png" />
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox
          x:Name="Network"
          Ribbon:KeyTip.Keys="N"
          Header="{DynamicResource tgNetworkCP}">
          <Ribbon:Button
            x:Name="btnMapDrive"
            Ribbon:KeyTip.Keys="M"
            Click="btnMapDrive_Click"
            Header="{DynamicResource btnMapDriveCP}"
            Icon="Images\condrive16.png"
            LargeIcon="Images\condrive32.png"
            SizeDefinition="Large,Middle,Middle" />
          <Ribbon:Button
            x:Name="btnDisconectDrive"
            Ribbon:KeyTip.Keys="D"
            Click="btnDisconectDrive_Click"
            Header="{DynamicResource btnDiscDriveCP}"
            Icon="Images\disdrive16.png"
            LargeIcon="Images\disdrive32.png"
            SizeDefinition="Large,Middle,Middle" />
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox Ribbon:KeyTip.Keys="G">
          <Ribbon:Button
            x:Name="btnAdvancedSecurity"
            Ribbon:KeyTip.Keys="A"
            Click="btnAdvancedSecurity_Click"
            Header="{DynamicResource btnAdvSecurityCP}"
            Icon="Images\advsec16.png"
            LargeIcon="Images\advsec32.png">
            <Ribbon:Button.ToolTip>
              <!--  "{DynamicResource btnAdvSecurityTCP}"  -->
              <Ribbon:ScreenTip
                Title="{DynamicResource btnAdvSecurityCP}"
                Width="250"
                Image="Images\advsec48.png"
                IsRibbonAligned="True"
                Text="{DynamicResource btnAdvSecurityTTX}" />
            </Ribbon:Button.ToolTip>
          </Ribbon:Button>
        </Ribbon:RibbonGroupBox>
      </Ribbon:RibbonTabItem>

      <Ribbon:RibbonTabItem
        x:Name="tbView"
        Ribbon:KeyTip.Keys="V"
        Header="{DynamicResource tbViewCP}"
        Indent="7"
        ReduceOrder="CurrentView,CurrentView,ShowHide,Layout,Layout,Layout,Panes,Panes,ShowHide,ShowHide,CurrentView,Panes">
        <Ribbon:RibbonGroupBox
          x:Name="Panes"
          Ribbon:KeyTip.Keys="P"
          Header="{DynamicResource tbPanesCP}">
          <Ribbon:ToggleButton
            x:Name="btnNavigationPane"
            Ribbon:KeyTip.Keys="NP"
            Checked="btnNavigationPane_CheckChanged"
            Header="{DynamicResource btnNavigationCP}"
            Icon="Images\navpane16.png"
            LargeIcon="Images\navpane32.png"
            SizeDefinition="Large,Middle,Middle"
            Unchecked="btnNavigationPane_CheckChanged">
            <Ribbon:ToggleButton.ToolTip>
              <!--  "{DynamicResource btnNavigationTCP}"  -->
              <Ribbon:ScreenTip
                Title="{DynamicResource btnNavigationCP}"
                Width="250"
                Image="Images\navpane48.png"
                IsRibbonAligned="True"
                Text="{DynamicResource btnNavigationTTX}" />
            </Ribbon:ToggleButton.ToolTip>
          </Ribbon:ToggleButton>
          <Ribbon:ToggleButton
            x:Name="btnPreviewPane"
            Ribbon:KeyTip.Keys="PP"
            Checked="btnPreviewPane_CheckChanged"
            Header="{DynamicResource btnPreviewCP}"
            Icon="Images\prevpane16.png"
            LargeIcon="Images\prevpane32.png"
            SizeDefinition="Middle,Middle,Middle"
            Unchecked="btnPreviewPane_CheckChanged">
            <Ribbon:ToggleButton.ToolTip>
              <!--  "{DynamicResource btnNavigationTCP}"  -->
              <Ribbon:ScreenTip
                Title="{DynamicResource btnNavigationCP}"
                Width="250"
                Image="Images\prevpane48.png"
                IsRibbonAligned="True"
                Text="{DynamicResource btnPreviewTTX}" />
            </Ribbon:ToggleButton.ToolTip>
          </Ribbon:ToggleButton>
          <Ribbon:ToggleButton
            x:Name="btnInfoPane"
            Ribbon:KeyTip.Keys="IP"
            Checked="btnInfoPane_CheckChanged"
            Header="{DynamicResource btnInfoCP}"
            Icon="Images\detailpane16.png"
            LargeIcon="Images\detailpane32.png"
            SizeDefinition="Middle,Middle,Middle"
            Unchecked="btnInfoPane_CheckChanged"
            Visibility="Collapsed">
            <Ribbon:ToggleButton.ToolTip>
              <!--  "{DynamicResource btnInfoTCP}"  -->
              <Ribbon:ScreenTip
                Title="{DynamicResource btnInfoCP}"
                Width="250"
                Image="Images\detailpane48.png"
                IsRibbonAligned="True"
                Text="{DynamicResource btnInfoTTX}" />
            </Ribbon:ToggleButton.ToolTip>
          </Ribbon:ToggleButton>
          <Ribbon:ToggleButton
            x:Name="btnConsolePane"
            Ribbon:KeyTip.Keys="PC"
            Click="btnConsolePane_Click"
            Header="Console"
            Icon="Images\console16.png"
            LargeIcon="Images\console32.png"
            SizeDefinition="Middle,Middle,Middle" />
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox
          x:Name="Layout"
          Ribbon:KeyTip.Keys="L"
          Header="{DynamicResource tgLayoutCP}">
          <Ribbon:InRibbonGallery
            x:Name="ViewGallery"
            Ribbon:KeyTip.Keys="V"
            CanCollapseToButton="True"
            GroupBy="Tag"
            Header="View Mode"
            ItemHeight="20"
            ItemWidth="130"
            MaxItemsInRow="3"
            MinItemsInDropDownRow="2"
            MinItemsInRow="3"
            Orientation="Horizontal"
            ResizeMode="Both"
            SelectedFilter="{Binding ElementName=galleryFilterAll}"
            SelectionChanged="inRibbonGallery1_SelectionChanged"
            SizeDefinition="Large,Large,Large">
            <Ribbon:InRibbonGallery.Filters>
              <Ribbon:GalleryGroupFilter
                x:Name="galleryFilterAll"
                Title="All"
                Groups="Standard Views,Additional Views" />
              <Ribbon:GalleryGroupFilter Title="Standard Views" Groups="Standard Views" />
              <Ribbon:GalleryGroupFilter Title="Additional Views" Groups="Additional Views" />
            </Ribbon:InRibbonGallery.Filters>
            <Ribbon:GalleryItem Tag="Standard Views">
              <StackPanel
                x:Name="ExtraLargeIconsPanel"
                Focusable="True"
                Orientation="Horizontal"
                Tag="Standard Views">
                <Image
                  x:Name="elarge"
                  Source="Images\elarge16.png"
                  Stretch="None" />
                <TextBlock
                  Margin="2,0,0,0"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Text="{DynamicResource btnExtraLargeICP}" />
              </StackPanel>
            </Ribbon:GalleryItem>
            <Ribbon:GalleryItem Tag="Standard Views">
              <StackPanel
                Focusable="True"
                Orientation="Horizontal"
                Tag="Standard Views">
                <Image Source="Images\large16.png" Stretch="None" />
                <TextBlock
                  Margin="2,0,0,0"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Text="{DynamicResource btnLargeICP}" />
              </StackPanel>
            </Ribbon:GalleryItem>
            <Ribbon:GalleryItem Tag="Standard Views">
              <StackPanel
                Focusable="True"
                Orientation="Horizontal"
                Tag="Standard Views">
                <Image Source="Images\medium16.png" Stretch="None" />
                <TextBlock
                  Margin="2,0,0,0"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Text="{DynamicResource btnMediumICP}" />
              </StackPanel>
            </Ribbon:GalleryItem>
            <Ribbon:GalleryItem Tag="Standard Views">
              <StackPanel
                Focusable="True"
                Orientation="Horizontal"
                Tag="Standard Views">
                <Image Source="Images\small16.png" Stretch="None" />
                <TextBlock
                  Margin="2,0,0,0"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Text="{DynamicResource btnSmallICP}" />
              </StackPanel>
            </Ribbon:GalleryItem>
            <Ribbon:GalleryItem Tag="Standard Views">
              <StackPanel
                Focusable="True"
                Orientation="Horizontal"
                Tag="Standard Views">
                <Image Source="Images\content16.png" Stretch="None" />
                <TextBlock
                  Margin="2,0,0,0"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Text="{DynamicResource btnListICP}" />
              </StackPanel>
            </Ribbon:GalleryItem>
            <Ribbon:GalleryItem Tag="Standard Views">
              <StackPanel
                Focusable="True"
                Orientation="Horizontal"
                Tag="Standard Views">
                <Image Source="Images\details16.png" Stretch="None" />
                <TextBlock
                  Margin="2,0,0,0"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Text="{DynamicResource btnDetailsICP}" />
              </StackPanel>
            </Ribbon:GalleryItem>
            <Ribbon:GalleryItem Tag="Standard Views">
              <StackPanel
                Focusable="True"
                Orientation="Horizontal"
                Tag="Standard Views">
                <Image Source="Images\tiles16.png" Stretch="None" />
                <TextBlock
                  Margin="2,0,0,0"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Text="{DynamicResource btnTilesICP}" />
              </StackPanel>
            </Ribbon:GalleryItem>
            <Ribbon:GalleryItem Tag="Additional Views">
              <StackPanel
                Focusable="True"
                Orientation="Horizontal"
                Tag="Additional Views">
                <Image Source="Images\content16.png" Stretch="None" />
                <TextBlock
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Text="{DynamicResource btnContentICP}" />
              </StackPanel>
            </Ribbon:GalleryItem>
            <Ribbon:GalleryItem Tag="Additional Views">
              <StackPanel
                Focusable="True"
                Orientation="Horizontal"
                Tag="Additional Views">
                <Image Source="Images\content16.png" Stretch="None" />
                <TextBlock
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Text="Thumbstrip" />
              </StackPanel>
            </Ribbon:GalleryItem>
            <!--  Slider Orientation="Horizontal" Tag="Additional Views" Interval="1" Minimum="48" Maximum="256" SmallChange="1" /  -->
          </Ribbon:InRibbonGallery>
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox
          x:Name="CurrentView"
          Ribbon:KeyTip.Keys="CV"
          Header="{DynamicResource tgCurrentViewCP}">
          <Ribbon:DropDownButton
            x:Name="btnSort"
            Ribbon:KeyTip.Keys="S"
            DropDownOpened="btnSort_DropDownOpened"
            Focusable="False"
            Header="{DynamicResource btnSortByCP}"
            Icon="Images\sort16.png"
            LargeIcon="Images\sort32.png"
            SizeDefinition="Large,Large,Small">
            <Ribbon:DropDownButton.ToolTip>
              <!--  "{DynamicResource btnSortHCP}"  -->
              <Ribbon:ScreenTip
                Title="{DynamicResource btnSortByCP}"
                Width="250"
                Image="Images\sort32.png"
                IsRibbonAligned="True"
                Text="{DynamicResource btnSortICP}" />
            </Ribbon:DropDownButton.ToolTip>
          </Ribbon:DropDownButton>
          <Ribbon:DropDownButton
            x:Name="btnGroup"
            Ribbon:KeyTip.Keys="G"
            DropDownOpened="btnGroup_DropDownOpened"
            Focusable="False"
            Header="{DynamicResource btnGroupByCP}"
            Icon="Images\groupby16.png"
            SizeDefinition="Middle,Small,Small" />
          <Ribbon:Button
            x:Name="btnAutosizeColls"
            Ribbon:KeyTip.Keys="CA"
            Click="btnAutosizeColls_Click"
            Header="{DynamicResource btnAutoSizeColCP}"
            Icon="Images\ascol16.png"
            SizeDefinition="Middle,Small,Small">
            <Ribbon:Button.ToolTip>
              <!--  "{DynamicResource btnAutoSizeColHCP}"  -->
              <Ribbon:ScreenTip
                Title="{DynamicResource btnAutoSizeColCP}"
                Width="250"
                IsRibbonAligned="True"
                Text="{DynamicResource btnAutoSizeColICP}" />
            </Ribbon:Button.ToolTip>
          </Ribbon:Button>
          <Ribbon:SplitButton
            x:Name="btnMoreColls"
            Ribbon:KeyTip.Keys="CM"
            Click="btnMoreColls_Click"
            Header="{DynamicResource btnMoreColCP}"
            Icon="Images\morecols16.png"
            SizeDefinition="Middle,Small,Small" />
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox
          x:Name="ShowHide"
          Ribbon:KeyTip.Keys="SH"
          Header="{DynamicResource tgShowHideCP}">
          <Ribbon:CheckBox
            x:Name="chkShowCheckBoxes"
            Ribbon:KeyTip.Keys="C"
            Checked="chkShowCheckBoxes_CheckChanged"
            Header="{DynamicResource chkShowCheckBoxesCP}"
            Unchecked="chkShowCheckBoxes_CheckChanged">
            <Ribbon:CheckBox.ToolTip>
              <Ribbon:ScreenTip
                Title="{DynamicResource chkShowCheckBoxesCP}"
                Width="250"
                IsRibbonAligned="false"
                Text="{DynamicResource chkShowCheckBoxesCP_Text}" />
            </Ribbon:CheckBox.ToolTip>
          </Ribbon:CheckBox>
          <Ribbon:CheckBox
            x:Name="chkHiddenFiles"
            Ribbon:KeyTip.Keys="D"
            Checked="chkHiddenFiles_Checked"
            Header="{DynamicResource chkHiddenItemsCP}"
            SizeDefinition="Middle,Middle,Small"
            Unchecked="chkHiddenFiles_Unchecked" />
          <Ribbon:CheckBox
            x:Name="chkExtensions"
            Ribbon:KeyTip.Keys="E"
            Checked="chkExtensions_Checked"
            Header="{DynamicResource chkExtensionsCP}"
            SizeDefinition="Middle,Middle,Small"
            Unchecked="chkExtensions_Unchecked">
            <Ribbon:CheckBox.ToolTip>
              <!--  Title="{DynamicResource chkExtensionsHCP}"  -->
              <Ribbon:ScreenTip
                Title="{DynamicResource chkExtensionsCP}"
                Width="250"
                IsRibbonAligned="True"
                Text="{DynamicResource chkExtensionsICP}" />
            </Ribbon:CheckBox.ToolTip>
          </Ribbon:CheckBox>
          <Ribbon:SplitButton
            x:Name="btnHideSelItems"
            Ribbon:KeyTip.Keys="H"
            Click="btnHideSelItems_Click"
            Header="{DynamicResource btnHideSelCP}"
            Icon="Images\hideitems16.png"
            LargeIcon="Images\hideitems48.png"
            SizeDefinition="Large,Small,Small">
            <Ribbon:MenuItem
              Ribbon:KeyTip.Keys="H"
              Click="btnHideSelItems_Click"
              Focusable="False"
              Header="{DynamicResource miHideSelCP}" />
            <Ribbon:MenuItem
              x:Name="miHideItems"
              Ribbon:KeyTip.Keys="C"
              Click="miHideItems_Click"
              Focusable="False"
              Header="{DynamicResource miHideItemsCP}" />
          </Ribbon:SplitButton>
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox Ribbon:KeyTip.Keys="W" Header="{DynamicResource grpWindowsCP}">
          <Ribbon:Button
            x:Name="btnNewWin"
            Click="btnNewWindow_Click"
            Content="New Window"
            Header="{DynamicResource btnNewWindowCP}"
            Icon="Images\new_window.png"
            LargeIcon="Images\new_window32.png" />
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox>
          <Ribbon:Button
            x:Name="btnRefresh"
            Ribbon:KeyTip.Keys="R"
            Click="btnRefresh_Click"
            Header="{DynamicResource btnRefreshCP}"
            Icon="Images\refresh16.png"
            LargeIcon="Images\Refresh32.png"
            SizeDefinition="Large" />
        </Ribbon:RibbonGroupBox>
      </Ribbon:RibbonTabItem>
      <Ribbon:RibbonTabItem
        Ribbon:KeyTip.Keys="L"
        Group="{Binding ElementName=ctgLibraries, Mode=OneWay}"
        Header="{DynamicResource tbManageCP}"
        ReduceOrder="ManageLibrary,ManageLibrary,ManageLibrary">
        <Ribbon:RibbonGroupBox
          x:Name="ManageLibrary"
          Ribbon:KeyTip.Keys="L"
          Header="{DynamicResource tgLibraryCP}"
          IsLauncherVisible="False">
          <Ribbon:Button
            x:Name="btnManageLib"
            Ribbon:KeyTip.Keys="M"
            Click="btnManageLib_Click"
            Header="{DynamicResource btnManageLibCP}"
            LargeIcon="Images\explorer32.png"
            SizeDefinition="Large" />
          <Ribbon:DropDownButton
            x:Name="btnDefSave"
            Ribbon:KeyTip.Keys="D"
            Header="{DynamicResource btnDefSaveCP}"
            Icon="Images\libsaveloc16.png"
            LargeIcon="Images\libsaveloc32.png"
            SizeDefinition="Large" />
          <Ribbon:DropDownButton
            Ribbon:KeyTip.Keys="O"
            Header="{DynamicResource btnOptimizeCP}"
            Icon="Images\libtype16.png"
            SizeDefinition="Middle,Middle,Small">
            <Ribbon:MenuItem
              x:Name="btnOLIGtem"
              Ribbon:KeyTip.Keys="G"
              Click="btnOLItem_Click"
              Header="{DynamicResource miGeneralCP}"
              Tag="gu" />
            <Ribbon:MenuItem
              x:Name="btnOLIDItem"
              Ribbon:KeyTip.Keys="D"
              Click="btnOLItem_Click"
              Header="{DynamicResource miDocumentsCP}"
              Tag="doc" />
            <Ribbon:MenuItem
              x:Name="btnOLIMItem"
              Ribbon:KeyTip.Keys="M"
              Click="btnOLItem_Click"
              Header="{DynamicResource miMusicCP}"
              Tag="mu" />
            <Ribbon:MenuItem
              x:Name="btnOLIPItem"
              Ribbon:KeyTip.Keys="P"
              Click="btnOLItem_Click"
              Header="{DynamicResource miPicturesCP}"
              Tag="pic" />
            <Ribbon:MenuItem
              x:Name="btnOLIVItem"
              Ribbon:KeyTip.Keys="V"
              Click="btnOLItem_Click"
              Header="{DynamicResource miVideosCP}"
              Tag="vid" />
          </Ribbon:DropDownButton>
          <Ribbon:Button
            x:Name="btnChangeLibIcon"
            Ribbon:KeyTip.Keys="I"
            Click="btnChangeLibIcon_Click"
            Header="{DynamicResource btnChangeLibIconCP}"
            Icon="Images\libicon16.png"
            LargeIcon="Images\libicon32.png"
            SizeDefinition="Middle,Middle,Small" />
          <Ribbon:CheckBox
            x:Name="chkPinNav"
            Ribbon:KeyTip.Keys="N"
            Checked="chkPinNav_CheckChanged"
            Header="{DynamicResource chkPinNavCP}"
            SizeDefinition="Middle,Middle,Small"
            Unchecked="chkPinNav_CheckChanged">
            <Ribbon:CheckBox.ToolTip>
              <Ribbon:ScreenTip
                Title="{DynamicResource chkPinNavHCP}"
                Width="250"
                IsRibbonAligned="True"
                Text="{DynamicResource chkPinNavICP}" />
            </Ribbon:CheckBox.ToolTip>
          </Ribbon:CheckBox>
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox x:Name="ResetLibrary" IsLauncherVisible="False">
          <Ribbon:Button
            x:Name="btnResetLibrary"
            Ribbon:KeyTip.Keys="R"
            Click="btnResetLibrary_Click"
            Header="{DynamicResource btnResetCP}"
            LargeIcon="Images\resetlib32.png"
            SizeDefinition="Large" />
        </Ribbon:RibbonGroupBox>
      </Ribbon:RibbonTabItem>
      <Ribbon:RibbonTabItem
        Ribbon:KeyTip.Keys="D"
        Group="{Binding ElementName=ctgDrive, Mode=OneWay}"
        Header="{DynamicResource tabDriveCP}">
        <Ribbon:RibbonGroupBox
          Ribbon:KeyTip.Keys="M"
          Header="{DynamicResource tbManageCP}"
          IsLauncherVisible="False">
          <Ribbon:Button
            x:Name="btnFormatDrive"
            Ribbon:KeyTip.Keys="F"
            Click="btnFormatDrive_Click"
            Header="{DynamicResource btnFormatDriveCP}"
            Icon="Images\formatd16.png"
            LargeIcon="Images\formatd.png"
            SizeDefinition="Large" />
          <Ribbon:Button
            x:Name="btnCleanDrive"
            Ribbon:KeyTip.Keys="C"
            Click="btnCleanDrive_Click"
            Header="{DynamicResource btnCleanDriveCP}"
            Icon="Images\cleand16.png"
            LargeIcon="Images\cleand32.png"
            SizeDefinition="Large" />
          <Ribbon:Button
            x:Name="btnDefragDrive"
            Ribbon:KeyTip.Keys="D"
            Click="btnDefragDrive_Click"
            Header="{DynamicResource btnDefragDriveCP}"
            Icon="Images\defrag16.png"
            LargeIcon="Images\defrag32.png"
            SizeDefinition="Large" />
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox
          x:Name="grpDriveDisk"
          Header="Remove"
          IsLauncherVisible="False">
          <Ribbon:SplitButton
            x:Name="btnOpenTray"
            Ribbon:KeyTip.Keys="O"
            Click="btnOpenTray_Click"
            Header="Open Tray"
            Icon="Images\cdtray16.png"
            LargeIcon="Images\cdtray32.png"
            SizeDefinition="Large">
            <Ribbon:MenuItem
              x:Name="btnCloseTray"
              Click="btnCloseTray_Click"
              Header="Close Tray" />
          </Ribbon:SplitButton>
          <Separator />
          <Ribbon:Button
            x:Name="btnEjectDevice"
            Ribbon:KeyTip.Keys="E"
            Click="btnEjectDevice_Click"
            Header="Eject"
            Icon="Images\removeusb16.png"
            LargeIcon="Images\removeusb32.png"
            SizeDefinition="Large" />
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox Header="Virtual">
          <Ribbon:Button
            x:Name="btnUnmountDrive"
            Ribbon:KeyTip.Keys="U"
            Click="btnUnmountDrive_Click"
            Header="Unmount"
            Icon="Images/unmount16.png"
            LargeIcon="Images/unmount32.png"
            SizeDefinition="Large" />
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox Header="" IsLauncherVisible="False">
          <Ribbon:Button
            x:Name="btnDSizeChart"
            Ribbon:KeyTip.Keys="Z"
            Click="btnFSizeChart_Click"
            Header="{DynamicResource btnDSizeChartCP}"
            Icon="Images\jssize16.png"
            LargeIcon="Images\jssize32.png" />
        </Ribbon:RibbonGroupBox>
      </Ribbon:RibbonTabItem>
      <Ribbon:RibbonTabItem
        Ribbon:KeyTip.Keys="A"
        Group="{Binding ElementName=ctgExe, Mode=OneWay}"
        Header="{DynamicResource tabApplicationCP}">
        <Ribbon:RibbonGroupBox
          Ribbon:KeyTip.Keys="R"
          Header="{DynamicResource tgRunCP}"
          IsLauncherVisible="False">
          <Ribbon:SplitButton
            x:Name="btnPin"
            Ribbon:KeyTip.Keys="P"
            Click="btnPin_Click"
            Header="{DynamicResource btnPinCP}"
            Icon="Images\pint16.png"
            LargeIcon="Images\pint32.png"
            SizeDefinition="Large">
            <Ribbon:MenuItem
              x:Name="btnPinToStart"
              Click="btnPinToStart_Click"
              Header="Pin to Start" />
          </Ribbon:SplitButton>
          <Separator />
          <Ribbon:Button
            x:Name="btnRunAsAdmin"
            Ribbon:KeyTip.Keys="A"
            Click="btnRunAsAdmin_Click"
            Header="{DynamicResource btnRunAsAdminCP}"
            Icon="Images\admin16.png"
            LargeIcon="Images\admin32.png"
            SizeDefinition="Large" />
          <Ribbon:Button
            x:Name="btnRunAs"
            Click="btnRunAs_Click"
            Header="Run As Another User"
            Icon="Images\users16.png"
            LargeIcon="Images\users32.png"
            SizeDefinition="Large"
            Visibility="Visible" />
        </Ribbon:RibbonGroupBox>
      </Ribbon:RibbonTabItem>
      <Ribbon:RibbonTabItem
        Ribbon:KeyTip.Keys="V"
        Group="{Binding ElementName=ctgVirtualDisk, Mode=OneWay}"
        Header="{DynamicResource tbManageCP}">
        <Ribbon:RibbonGroupBox>
          <Ribbon:Button
            x:Name="btnAdvMountIso"
            Click="btnAdvMountIso_Click"
            Header="Mount as Drive"
            Icon="Images/mount16.png"
            LargeIcon="Images/mount32.png"
            SizeDefinition="Large" />
          <Ribbon:Button
            x:Name="btnMountIso"
            Click="btnMountIso_Click"
            Header="Quick Mount as Drive"
            Icon="Images/qmount16.png"
            LargeIcon="Images/qmount32.png"
            SizeDefinition="Large" />
          <Separator />
          <Ribbon:Button
            x:Name="btnWriteIso"
            Click="btnWriteIso_Click"
            Header="Burn to Disk"
            Icon="Images/burn16.png"
            LargeIcon="Images/burn32.png"
            SizeDefinition="Large" />
        </Ribbon:RibbonGroupBox>
      </Ribbon:RibbonTabItem>

      <Ribbon:RibbonTabItem
        Ribbon:KeyTip.Keys="I"
        Group="{Binding ElementName=ctgImage, Mode=OneWay}"
        Header="{DynamicResource tbManageCP}"
        ReduceOrder="imgView,imgView,imgView,imgEdit">
        <Ribbon:RibbonGroupBox
          x:Name="imgEdit"
          Ribbon:KeyTip.Keys="O"
          Header="{DynamicResource tgImgEditCP}"
          IsLauncherVisible="False">
          <Ribbon:Button
            x:Name="btnRotateLeft"
            Ribbon:KeyTip.Keys="L"
            Click="RotateImages"
            Header="{DynamicResource btnRotateLeftCP}"
            Icon="Images\rl16.png"
            LargeIcon="Images\rl32.png"
            SizeDefinition="Large,Large,Large" />
          <Ribbon:Button
            x:Name="btnRotateRight"
            Ribbon:KeyTip.Keys="R"
            Click="RotateImages"
            Header="{DynamicResource btnRotateRightCP}"
            Icon="Images\rr16.png"
            LargeIcon="Images\rr32.png"
            SizeDefinition="Large,Large,Large" />
          <Ribbon:Button
            x:Name="btnFlipX"
            Ribbon:KeyTip.Keys="X"
            Click="RotateImages"
            Header="{DynamicResource btnFlipXCP}"
            Icon="Images\fh16.png"
            LargeIcon="Images\fh32.png"
            SizeDefinition="Large,Middle,Middle" />
          <Ribbon:Button
            x:Name="btnFlipY"
            Ribbon:KeyTip.Keys="Y"
            Click="RotateImages"
            Header="{DynamicResource btnFlipYCP}"
            Icon="Images\fv16.png"
            LargeIcon="Images\fv32.png"
            SizeDefinition="Large,Middle,Middle" />
          <Ribbon:DropDownButton
            x:Name="btnConvertImage"
            Ribbon:KeyTip.Keys="C"
            Header="{DynamicResource btnConvertImageCP}"
            Icon="Images\convert16.png"
            LargeIcon="Images\convert32.png"
            SizeDefinition="Large,Middle,Middle">
            <Ribbon:MenuItem
              x:Name="ConvertToJPG"
              Ribbon:KeyTip.Keys="J"
              Click="Convert_Images"
              Header="{DynamicResource miJPGfCP}" />
            <Ribbon:MenuItem
              x:Name="ConvertToPNG"
              Ribbon:KeyTip.Keys="P"
              Click="Convert_Images"
              Header="{DynamicResource miPNGfCP}" />
            <Ribbon:MenuItem
              x:Name="ConvertToGIF"
              Ribbon:KeyTip.Keys="G"
              Click="Convert_Images"
              Header="{DynamicResource miGIFfCP}" />
            <Ribbon:MenuItem
              x:Name="ConvertToBMP"
              Ribbon:KeyTip.Keys="G"
              Click="Convert_Images"
              Header="{DynamicResource miBMPfCP}" />
            <Ribbon:MenuItem
              x:Name="ConvertToWMF"
              Ribbon:KeyTip.Keys="W"
              Click="Convert_Images"
              Header="{DynamicResource miWMFfCP}" />
          </Ribbon:DropDownButton>
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox
          x:Name="imgSize"
          Ribbon:KeyTip.Keys="S"
          Header="{DynamicResource grpSizeCP}">
          <Ribbon:RibbonToolBar x:Name="tlbrImageSize">
            <!--  ToolBar Layout Definitions  -->
            <Ribbon:RibbonToolBar.LayoutDefinitions>
              <!--  Large Size of the RibbonToolBar  -->
              <Ribbon:RibbonToolBarLayoutDefinition Size="Large">
                <Ribbon:RibbonToolBarRow>
                  <Ribbon:RibbonToolBarControlDefinition Target="imgSizeDisplay" />
                </Ribbon:RibbonToolBarRow>
              </Ribbon:RibbonToolBarLayoutDefinition>
              <!--  Middle Size of the RibbonToolBar  -->
              <Ribbon:RibbonToolBarLayoutDefinition Size="Middle">
                <Ribbon:RibbonToolBarRow>
                  <Ribbon:RibbonToolBarControlDefinition Target="imgSizeDisplay" />
                </Ribbon:RibbonToolBarRow>
                <!--
          <Ribbon:RibbonToolBarRow>
          <Ribbon:RibbonToolBarControlDefinition Target="imgWidth" />
          <Ribbon:RibbonToolBarControlDefinition Target="imgdWidth" Width="50"/>
          </Ribbon:RibbonToolBarRow>
          <Ribbon:RibbonToolBarRow>
          <Ribbon:RibbonToolBarControlDefinition Target="imgHeight" />
          <Ribbon:RibbonToolBarControlDefinition Target="imgdHeight" Width="50"/>
          </Ribbon:RibbonToolBarRow>
        -->
              </Ribbon:RibbonToolBarLayoutDefinition>
              <!--  Small Size of the RibbonToolBar  -->
              <Ribbon:RibbonToolBarLayoutDefinition Size="Small">
                <Ribbon:RibbonToolBarRow>
                  <Ribbon:RibbonToolBarControlDefinition Target="imgSizeDisplay" />
                </Ribbon:RibbonToolBarRow>
              </Ribbon:RibbonToolBarLayoutDefinition>
            </Ribbon:RibbonToolBar.LayoutDefinitions>
            <!--  ToolBar Controls  -->
            <controls:ImageSizeDisplay
              x:Name="imgSizeDisplay"
              Margin="4,0,0,0"
              HeightName="{StaticResource lblHeightCP}"
              WidthName="{StaticResource lblWidthCP}" />
            <TextBlock
              x:Name="imgWidth"
              Margin="4,0,0,0"
              Text="{DynamicResource lblWidthCP}" />
            <TextBlock
              x:Name="imgHeight"
              Margin="4,0,0,0"
              Text="{DynamicResource lblHeightCP}" />
            <TextBox
              x:Name="imgdWidth"
              Background="#FFE0E0E0"
              Focusable="True"
              IsReadOnly="True"
              IsReadOnlyCaretVisible="True" />
            <TextBox
              x:Name="imgdHeight"
              Background="#FFE0E0E0"
              Focusable="True"
              IsReadOnly="True"
              IsReadOnlyCaretVisible="True" />
          </Ribbon:RibbonToolBar>
          <Separator />
          <Ribbon:Button
            x:Name="btnResize"
            Ribbon:KeyTip.Keys="Z"
            Click="btnResize_Click"
            Header="{DynamicResource btnResizeCP}"
            Icon="Images\resize16.png"
            LargeIcon="Images\resize32.png"
            SizeDefinition="Large" />
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox
          x:Name="imgView"
          Ribbon:KeyTip.Keys="V"
          Header="{DynamicResource tgImgViewCP}"
          IsLauncherVisible="False">
          <!--
      <Ribbon:Button x:Name="btnSlideShow"
      Header="{DynamicResource btnSlideShowCP}"
      LargeIcon="Images\slideshow32.png"
      Ribbon:KeyTip.Keys="H"
      SizeDefinition="Large"
      Visibility="Collapsed" />
      -->
          <Ribbon:SplitButton
            x:Name="btnWallpaper"
            Ribbon:KeyTip.Keys="W"
            Click="Set_Wallpaper"
            Header="{DynamicResource btnWallpaperCP}"
            LargeIcon="Images\sawall32.png"
            SizeDefinition="Large">
            <Ribbon:MenuItem
              x:Name="miWallFill"
              Ribbon:KeyTip.Keys="L"
              Click="Set_Wallpaper"
              Header="{DynamicResource miWallFillCP}" />
            <Ribbon:MenuItem
              x:Name="miWallFit"
              Ribbon:KeyTip.Keys="F"
              Click="Set_Wallpaper"
              Header="{DynamicResource miWallFitCP}" />
            <Ribbon:MenuItem
              x:Name="miWallStretch"
              Ribbon:KeyTip.Keys="S"
              Click="Set_Wallpaper"
              Header="{DynamicResource miWallStretchCP}" />
            <Ribbon:MenuItem
              x:Name="miWallTile"
              Ribbon:KeyTip.Keys="T"
              Click="Set_Wallpaper"
              Header="{DynamicResource miWallTileCP}" />
            <Ribbon:MenuItem
              x:Name="miWallCenter"
              Ribbon:KeyTip.Keys="C"
              Click="Set_Wallpaper"
              Header="{DynamicResource miWallCenterCP}" />
          </Ribbon:SplitButton>
        </Ribbon:RibbonGroupBox>
      </Ribbon:RibbonTabItem>
      <Ribbon:RibbonTabItem
        Ribbon:KeyTip.Keys="A"
        Group="{Binding ElementName=ctgArchive, Mode=OneWay}"
        Header="{DynamicResource tbManageCP}"
        ReduceOrder="grpExtract,grpManArchive,grpExtract,grpManArchive,grpManArchive">
        <Ribbon:RibbonGroupBox
          x:Name="grpExtract"
          Ribbon:KeyTip.Keys="X"
          Header="{DynamicResource tgExtractCP}"
          IsLauncherEnabled="False"
          IsLauncherVisible="False">
          <Ribbon:Button
            x:Name="btnExtractHere"
            Ribbon:KeyTip.Keys="H"
            Click="miExtractHere_Click"
            Header="{DynamicResource btnExtractHereCP}"
            Icon="Images\zipeztract16.png"
            LargeIcon="Images\zipeztract32.png"
            SizeDefinition="Large">
            <Ribbon:Button.ToolTip>
              <Ribbon:ScreenTip
                Title="{DynamicResource btnExtractHereHCP}"
                Width="250"
                IsRibbonAligned="True"
                Text="{DynamicResource btnExtractHereICP}" />
            </Ribbon:Button.ToolTip>
          </Ribbon:Button>
          <Separator />
          <Ribbon:RibbonToolBar x:Name="tlbrExtract">
            <!--  ToolBar Layout Definitions  -->
            <Ribbon:RibbonToolBar.LayoutDefinitions>
              <!--  Large Size of the RibbonToolBar  -->
              <Ribbon:RibbonToolBarLayoutDefinition Size="Large">
                <Ribbon:RibbonToolBarRow>
                  <Ribbon:RibbonToolBarControlDefinition Target="lblExtract" />
                  <Ribbon:RibbonToolBarControlDefinition Width="400" Target="txtExtractLocation" />
                </Ribbon:RibbonToolBarRow>
                <Ribbon:RibbonToolBarRow>
                  <Ribbon:RibbonToolBarControlDefinition Target="btnChooseLocation" />
                  <Ribbon:RibbonToolBarControlDefinition Target="btnExtractNow" />
                </Ribbon:RibbonToolBarRow>
                <Ribbon:RibbonToolBarRow>
                  <Ribbon:RibbonToolBarControlDefinition Target="chkUseNewFolder" />
                  <!--  <Ribbon:RibbonToolBarControlDefinition Target="chkOpenResults" />  -->
                </Ribbon:RibbonToolBarRow>
              </Ribbon:RibbonToolBarLayoutDefinition>
              <!--  Middle Size of the RibbonToolBar  -->
              <Ribbon:RibbonToolBarLayoutDefinition Size="Middle">
                <Ribbon:RibbonToolBarRow>
                  <Ribbon:RibbonToolBarControlDefinition Target="lblExtract" />
                  <Ribbon:RibbonToolBarControlDefinition Width="300" Target="txtExtractLocation" />
                </Ribbon:RibbonToolBarRow>
                <Ribbon:RibbonToolBarRow>
                  <Ribbon:RibbonToolBarControlDefinition Target="btnChooseLocation" />
                  <Ribbon:RibbonToolBarControlDefinition Target="btnExtractNow" />
                </Ribbon:RibbonToolBarRow>
                <Ribbon:RibbonToolBarRow>
                  <Ribbon:RibbonToolBarControlDefinition Target="chkUseNewFolder" />
                  <!--  <Ribbon:RibbonToolBarControlDefinition Target="chkOpenResults" />  -->
                </Ribbon:RibbonToolBarRow>
              </Ribbon:RibbonToolBarLayoutDefinition>

              <!--  Small Size of the RibbonToolBar  -->
              <Ribbon:RibbonToolBarLayoutDefinition Size="Small">
                <Ribbon:RibbonToolBarRow>
                  <Ribbon:RibbonToolBarControlDefinition Target="lblExtract" />
                  <Ribbon:RibbonToolBarControlDefinition Width="200" Target="txtExtractLocation" />
                </Ribbon:RibbonToolBarRow>
                <Ribbon:RibbonToolBarRow>
                  <Ribbon:RibbonToolBarControlDefinition Target="btnChooseLocation" />
                  <Ribbon:RibbonToolBarControlDefinition Target="btnExtractNow" />
                </Ribbon:RibbonToolBarRow>
                <Ribbon:RibbonToolBarRow>
                  <Ribbon:RibbonToolBarControlDefinition Target="chkUseNewFolder" />
                  <!--  <Ribbon:RibbonToolBarControlDefinition Target="chkOpenResults" />  -->
                </Ribbon:RibbonToolBarRow>
              </Ribbon:RibbonToolBarLayoutDefinition>
            </Ribbon:RibbonToolBar.LayoutDefinitions>

            <!--  ToolBar Controls  -->
            <TextBlock
              x:Name="lblExtract"
              Margin="4,0,0,0"
              Text="{DynamicResource lblExtractCP}" />
            <TextBox x:Name="txtExtractLocation" />
            <Ribbon:Button
              x:Name="btnChooseLocation"
              Click="btnChooseLocation_Click"
              Header="{DynamicResource btnChooseLocationCP}"
              Icon="Images\folder_new16.png"
              SizeDefinition="Middle" />
            <Ribbon:Button
              x:Name="btnExtractNow"
              Click="btnExtractNow_Click"
              Header="{DynamicResource btnExtractNowCP}"
              Icon="Images\archiver16.png"
              SizeDefinition="Middle" />
            <Ribbon:CheckBox
              x:Name="chkUseNewFolder"
              Ribbon:KeyTip.Keys="F"
              Header="{DynamicResource chkUseNewFolderCP}"
              IsChecked="True" />
            <Ribbon:CheckBox
              x:Name="chkOpenResults"
              Ribbon:KeyTip.Keys="D"
              Header="{DynamicResource chkOpenResultsCP}"
              IsChecked="False" />
          </Ribbon:RibbonToolBar>
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox
          x:Name="grpManArchive"
          Ribbon:KeyTip.Keys="A"
          Header="{DynamicResource tbManageCP}"
          IsLauncherVisible="False">
          <Ribbon:Button
            x:Name="btnCheckArchive"
            Ribbon:KeyTip.Keys="C"
            Click="btnCheckArchive_Click"
            Header="{DynamicResource btnCheckArchiveCP}"
            Icon="Images\archivecheck16.png"
            LargeIcon="Images\archivecheck32.png"
            SizeDefinition="Large" />
          <Ribbon:Button
            x:Name="btnViewArchive"
            Ribbon:KeyTip.Keys="V"
            Click="btnViewArchive_Click"
            Header="{DynamicResource btnViewArchiveCP}"
            Icon="Images\archiveview16.png"
            LargeIcon="Images\archiveview32.png"
            SizeDefinition="Large"
            Visibility="Visible" />
        </Ribbon:RibbonGroupBox>
      </Ribbon:RibbonTabItem>
      <Ribbon:RibbonTabItem
        Ribbon:KeyTip.Keys="M"
        Group="{Binding ElementName=ctgFolderTools, Mode=OneWay}"
        Header="{DynamicResource tbManageCP}">
        <Ribbon:RibbonGroupBox
          Ribbon:KeyTip.Keys="I"
          Header="{DynamicResource tgFolderIconCP}"
          IsLauncherVisible="False">
          <Ribbon:Button
            x:Name="btnChangeFoldericon"
            Ribbon:KeyTip.Keys="C"
            Click="btnChangeFoldericon_Click"
            Header="{DynamicResource btnChangeFIconCP}"
            Icon="Images\fcustc16.png"
            LargeIcon="Images\fcustc32.png" />
          <Ribbon:Button
            x:Name="btnClearFoldericon"
            Ribbon:KeyTip.Keys="R"
            Click="btnClearFoldericon_Click"
            Header="{DynamicResource btnClearFIconCP}"
            Icon="Images\fcust16.png"
            LargeIcon="Images\fcust32.png" />
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox Ribbon:KeyTip.Keys="S" IsLauncherVisible="False">
          <Ribbon:Button
            x:Name="btnFSizeChart"
            Ribbon:KeyTip.Keys="Z"
            Click="btnFSizeChart_Click"
            Header="{DynamicResource btnFSizeChartCP}"
            Icon="Images\jssize16.png"
            LargeIcon="Images\jssize32.png" />
        </Ribbon:RibbonGroupBox>
      </Ribbon:RibbonTabItem>
      <Ribbon:RibbonTabItem
        x:Name="tbSearch"
        Ribbon:KeyTip.Keys="S"
        Group="{Binding ElementName=ctgSearch, Mode=OneWay}"
        Header="{DynamicResource tabSearchCP}"
        ReduceOrder="tsgKind,tsgKind,tsgOther,tsgOther,tsgKind,tsgOther">
        <!--
      <Ribbon:RibbonGroupBox Header="Modifiers" IsLauncherVisible="False" Name="tsgModifiers">
      <Ribbon:ToggleButton SizeDefinition="Middle" Header="AND" Tag="AND" GroupName="b1" Visibility="Collapsed"/>
      <Ribbon:ToggleButton SizeDefinition="Middle" Header="OR" Tag="OR" GroupName="b1"/>
      <Ribbon:ToggleButton SizeDefinition="Middle" Header="NOT" Tag="NOT" GroupName="b1"/>
      </Ribbon:RibbonGroupBox>
    -->
        <Ribbon:RibbonGroupBox
          x:Name="tsgKind"
          Header="{DynamicResource tsgKindCP}"
          IsLauncherVisible="False">
          <Ribbon:ToggleButton
            x:Name="btnSearchEverything"
            Click="ToggleButton_Click"
            GroupName="k1"
            Header="{DynamicResource btnKindAllCP}"
            Icon="Images\jseverything16.png"
            IsChecked="True"
            LargeIcon="Images\jseverything32.png"
            SizeDefinition="Large"
            Tag=":null:" />
          <Ribbon:ToggleButton
            x:Name="btnSearchDocuments"
            Click="ToggleButton_Click"
            GroupName="k1"
            Header="{DynamicResource btnKindDocsCP}"
            Icon="Images\jsdocs16.png"
            LargeIcon="Images\jsdocs32.png"
            SizeDefinition="Large,Middle,Middle"
            Tag="kind:docs" />
          <Ribbon:ToggleButton
            x:Name="btnSearchPictures"
            Click="ToggleButton_Click"
            GroupName="k1"
            Header="{DynamicResource btnKindPicsCP}"
            Icon="Images\jsimages16.png"
            LargeIcon="Images\jsimages32.png"
            SizeDefinition="Large,Middle,Middle"
            Tag="kind:pics" />
          <Ribbon:ToggleButton
            x:Name="btnSearchMusic"
            Click="ToggleButton_Click"
            GroupName="k1"
            Header="{DynamicResource btnKindMusicCP}"
            Icon="Images\jsmusic16.png"
            LargeIcon="Images\jsmusic32.png"
            SizeDefinition="Large,Middle,Middle"
            Tag="kind:music" />
          <Ribbon:ToggleButton
            x:Name="btnSearchVideos"
            Click="ToggleButton_Click"
            GroupName="k1"
            Header="{DynamicResource btnKindVideosCP}"
            Icon="Images\jsvideos16.png"
            LargeIcon="Images\jsvideos32.png"
            SizeDefinition="Middle"
            Tag="kind:videos" />
          <Ribbon:ToggleButton
            x:Name="btnSearchFolders"
            Click="ToggleButton_Click"
            GroupName="k1"
            Header="{DynamicResource btnKindFoldersCP}"
            Icon="Images\jsfolders16.png"
            LargeIcon="Images\jsfolders32.png"
            SizeDefinition="Middle"
            Tag="kind:folders" />
          <Ribbon:ToggleButton
            x:Name="btnSearchPrograms"
            Click="ToggleButton_Click"
            GroupName="k1"
            Header="{DynamicResource btnKindProgramsCP}"
            Icon="Images\jsprograms16.png"
            LargeIcon="Images\jsprograms32.png"
            SizeDefinition="Middle"
            Tag="kind:programs" />
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox
          x:Name="tsgOther"
          Header="{DynamicResource tsgOtherCP}"
          IsLauncherVisible="False">
          <Ribbon:SplitButton
            x:Name="scSize"
            Click="miCustomSize_Click"
            Header="{DynamicResource btnOSizeCP}"
            Icon="Images\jssize16.png"
            IsCheckable="True"
            LargeIcon="Images\jssize32.png"
            SizeDefinition="Large,Middle,Middle">
            <Ribbon:MenuItem
              Click="MenuItem_Click_5"
              GroupName="s1"
              Header="{DynamicResource miSizeVLargeCP}"
              IsCheckable="True"
              Tag="size:&gt;128MB" />
            <Ribbon:MenuItem
              Click="MenuItem_Click_5"
              GroupName="s1"
              Header="{DynamicResource miSizeLargeCP}"
              IsCheckable="True"
              Tag="size:1MB..128MB" />
            <Ribbon:MenuItem
              Click="MenuItem_Click_5"
              GroupName="s1"
              Header="{DynamicResource miSizeMiddleCP}"
              IsCheckable="True"
              Tag="size:100KB..1MB" />
            <Ribbon:MenuItem
              Click="MenuItem_Click_5"
              GroupName="s1"
              Header="{DynamicResource miSizeSmallCP}"
              IsCheckable="True"
              Tag="size:10KB..100KB" />
            <Ribbon:MenuItem
              Click="MenuItem_Click_5"
              GroupName="s1"
              Header="{DynamicResource miSizeTinyCP}"
              IsCheckable="True"
              Tag="size:&lt;10KB" />
            <Separator />
            <Ribbon:MenuItem
              x:Name="miCustomSize"
              Click="miCustomSize_Click"
              Header="{DynamicResource miCustomSizeCP}" />
          </Ribbon:SplitButton>
          <Ribbon:SplitButton
            x:Name="dcsplit"
            Click="dcCustomTime_Click"
            Header="{DynamicResource btnODateCCP}"
            Icon="Images\jsdc16.png"
            IsCheckable="True"
            LargeIcon="Images\jsdc32.png"
            SizeDefinition="Large,Middle,Middle">
            <Ribbon:MenuItem
              Click="MenuItem_Click_4"
              GroupName="s2"
              Header="{DynamicResource miDateTodayCP}"
              IsCheckable="True"
              Tag="date:today" />
            <Ribbon:MenuItem
              Click="MenuItem_Click_4"
              GroupName="s2"
              Header="{DynamicResource miDateYesterdayCP}"
              IsCheckable="True"
              Tag="date:yesterday" />
            <Ribbon:MenuItem
              Click="MenuItem_Click_4"
              GroupName="s2"
              Header="{DynamicResource miDateThisWeekCP}"
              IsCheckable="True"
              Tag="date:this week" />
            <Ribbon:MenuItem
              Click="MenuItem_Click_4"
              GroupName="s2"
              Header="{DynamicResource miDateLastWeekCP}"
              IsCheckable="True"
              Tag="date:last week" />
            <Ribbon:MenuItem
              Click="MenuItem_Click_4"
              GroupName="s2"
              Header="{DynamicResource miPastMonthCP}"
              IsCheckable="True"
              Tag="date:past month" />
            <Separator />
            <Ribbon:MenuItem
              x:Name="dcCustomTime"
              Click="dcCustomTime_Click"
              Header="{DynamicResource miDateCustomCP}" />
          </Ribbon:SplitButton>
          <Ribbon:SplitButton
            x:Name="dmsplit"
            Click="dmCustomTime_Click"
            Header="{DynamicResource btnODateModCP}"
            Icon="Images\jsdm16.png"
            IsCheckable="True"
            LargeIcon="Images\jsdm32.png"
            SizeDefinition="Large,Middle,Middle">
            <Ribbon:MenuItem
              Click="MenuItem_Click_3"
              GroupName="s3"
              Header="{DynamicResource miDateTodayCP}"
              IsCheckable="True"
              Tag="modified:today" />
            <Ribbon:MenuItem
              Click="MenuItem_Click_3"
              GroupName="s3"
              Header="{DynamicResource miDateYesterdayCP}"
              IsCheckable="True"
              Tag="modified:yesterday" />
            <Ribbon:MenuItem
              Click="MenuItem_Click_3"
              GroupName="s3"
              Header="{DynamicResource miDateThisWeekCP}"
              IsCheckable="True"
              Tag="modified:this week" />
            <Ribbon:MenuItem
              Click="MenuItem_Click_3"
              GroupName="s3"
              Header="{DynamicResource miDateLastWeekCP}"
              IsCheckable="True"
              Tag="modified:last week" />
            <Ribbon:MenuItem
              Click="MenuItem_Click_3"
              GroupName="s3"
              Header="{DynamicResource miPastMonthCP}"
              IsCheckable="True"
              Tag="modified:past month" />
            <Separator />
            <Ribbon:MenuItem
              x:Name="dmCustomTime"
              Click="dmCustomTime_Click"
              Header="{DynamicResource miDateCustomCP}" />
          </Ribbon:SplitButton>
          <Ribbon:ToggleButton
            x:Name="ExtToggle"
            Click="ToggleButton_Click_1"
            Header="{DynamicResource btnExtCP}"
            Icon="Images\jsext16.png"
            LargeIcon="Images\jsext32.png"
            SizeDefinition="Middle"
            Tag="ext:" />
          <Ribbon:ToggleButton
            x:Name="AuthorToggle"
            Click="AuthorToggle_Click"
            Header="{DynamicResource btnAuthorCP}"
            Icon="Images\jsauthor16.png"
            LargeIcon="Images\jsauthor32.png"
            SizeDefinition="Middle"
            Tag="author:" />
          <Ribbon:ToggleButton
            x:Name="SubjectToggle"
            Click="SubjectToggle_Click"
            Header="{DynamicResource btnSubjectCP}"
            Icon="Images\jssubject16.png"
            LargeIcon="Images\jssubject32.png"
            SizeDefinition="Middle"
            Tag="subject:" />
        </Ribbon:RibbonGroupBox>
        <Ribbon:RibbonGroupBox>
          <Ribbon:Button
            x:Name="btnSearch"
            Click="btnSearch_Click"
            Header="{DynamicResource btnSearchCP}"
            Icon="Images\jssearch16.png"
            LargeIcon="Images\jssearch32.png"
            SizeDefinition="Large,Middle,Middle" />
          <!--
      <Ribbon:Button Header="Advanced Search"
      Icon="Images\searchadv16.png"
      LargeIcon="Images\searchadv32.png"
      SizeDefinition="Large,Middle,Middle"
      Visibility="Collapsed" />
      -->
        </Ribbon:RibbonGroupBox>
      </Ribbon:RibbonTabItem>
    </Ribbon:Ribbon>
    <Button
      x:Name="btnUpLevel"
      Grid.Row="1"
      Width="25"
      Height="25"
      Margin="80,5,0,0"
      HorizontalAlignment="Left"
      VerticalAlignment="Top"
      Click="btnUpLevel_Click"
      ToolTip="{DynamicResource txtLevelUp}">
      <Button.Template>
        <ControlTemplate TargetType="{x:Type Button}">
          <Grid Background="{DynamicResource WhiteBrush}">
            <Path
              x:Name="btnUpPath"
              Width="25"
              Height="22"
              Margin="0,0,0,0"
              HorizontalAlignment="Right"
              Data="{StaticResource arrow}"
              Fill="{DynamicResource GrayBrush2}"
              RenderTransformOrigin=".5,.5"
              Stretch="Fill">
              <Path.RenderTransform>
                <TransformGroup>
                  <RotateTransform Angle="270" />
                  <ScaleTransform ScaleX="0.7" ScaleY="0.7" />
                </TransformGroup>
              </Path.RenderTransform>
            </Path>
          </Grid>
          <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="btnUpPath" Property="Fill" Value="{DynamicResource BlackBrush}" />
            </Trigger>
            <Trigger Property="IsMouseOver" Value="False">
              <Setter TargetName="btnUpPath" Property="Fill" Value="{DynamicResource GrayBrush2}" />
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
              <Setter TargetName="btnUpPath" Property="Fill" Value="{DynamicResource BlackBrush}" />
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter TargetName="btnUpPath" Property="Opacity" Value="0.5" />
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Button.Template>
    </Button>
    <Grid
      x:Name="navBarGrid"
      Grid.Row="1"
      Width="75"
      Height="30"
      Margin="10,3,0,0"
      HorizontalAlignment="Left"
      VerticalAlignment="Top">
      <Button
        x:Name="leftNavBut"
        Width="30"
        Margin="0,2,0,2"
        HorizontalAlignment="Left"
        Background="{x:Null}"
        BorderBrush="#70000000"
        Click="leftNavBut_Click"
        Content="Left"
        ToolTip="{DynamicResource txtBack}">
        <Button.Template>
          <ControlTemplate TargetType="{x:Type Button}">
            <Grid Background="{DynamicResource WhiteBrush}">
              <Path
                x:Name="btnBackPathCircle"
                Width="25"
                Height="25"
                Margin="0,0,0,0"
                HorizontalAlignment="Center"
                Data="{StaticResource arrowCircle}"
                Fill="{DynamicResource GrayBrush2}"
                RenderTransformOrigin=".5,.5"
                Stretch="Fill" Visibility="Collapsed"/>
              <Path
                x:Name="btnBackPath"
                Width="25"
                Height="25"
                Margin="0,0,0,0"
                HorizontalAlignment="Center"
                Data="{StaticResource arrow}"
                Fill="{DynamicResource GrayBrush2}"
                RenderTransformOrigin=".5,.5"
                Stretch="Fill">
                <Path.RenderTransform>
                  <TransformGroup>
                    <RotateTransform Angle="180" />
                    <ScaleTransform ScaleX="0.7" ScaleY="0.7" />
                  </TransformGroup>
                </Path.RenderTransform>
              </Path>
            </Grid>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="btnBackPath" Property="Fill" Value="{DynamicResource BlackBrush}" />
                <Setter TargetName="btnBackPathCircle" Property="Fill" Value="{DynamicResource BlackBrush}" />
              </Trigger>
              <Trigger Property="IsMouseOver" Value="False">
                <Setter TargetName="btnBackPath" Property="Fill" Value="{DynamicResource GrayBrush2}" />
                <Setter TargetName="btnBackPathCircle" Property="Fill" Value="{DynamicResource GrayBrush2}" />
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter TargetName="btnBackPath" Property="Fill" Value="{DynamicResource BlackBrush}" />
                <Setter TargetName="btnBackPathCircle" Property="Fill" Value="{DynamicResource BlackBrush}" />
              </Trigger>
              <Trigger Property="IsEnabled" Value="False">
                <Setter TargetName="btnBackPath" Property="Opacity" Value="0.5" />
                <Setter TargetName="btnBackPathCircle" Property="Opacity" Value="0.5" />
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Button.Template>
      </Button>
      <Button
        x:Name="rightNavBut"
        Width="30"
        Margin="27,2,0,2"
        HorizontalAlignment="Left"
        Background="{x:Null}"
        Click="rightNavBut_Click"
        ToolTip="{DynamicResource txtForward}">
        <Button.Template>
          <ControlTemplate TargetType="{x:Type Button}">
            <Grid Background="{DynamicResource WhiteBrush}">
              <Path
                x:Name="btnFFPath"
                Width="25"
                Height="25"
                Margin="0,0,0,0"
                HorizontalAlignment="Center"
                Data="{StaticResource arrow}"
                Fill="{DynamicResource GrayBrush2}"
                RenderTransformOrigin=".5,.5"
                Stretch="Fill">
                <Path.RenderTransform>
                  <TransformGroup>
                    <RotateTransform Angle="0" />
                    <ScaleTransform ScaleX="0.7" ScaleY="0.7" />
                  </TransformGroup>
                </Path.RenderTransform>
              </Path>
            </Grid>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="btnFFPath" Property="Fill" Value="{DynamicResource BlackBrush}" />
              </Trigger>
              <Trigger Property="IsMouseOver" Value="False">
                <Setter TargetName="btnFFPath" Property="Fill" Value="{DynamicResource GrayBrush2}" />
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter TargetName="btnFFPath" Property="Fill" Value="{DynamicResource BlackBrush}" />
              </Trigger>
              <Trigger Property="IsEnabled" Value="False">
                <Setter TargetName="btnFFPath" Property="Opacity" Value="0.5" />
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Button.Template>
      </Button>
      <Button
        x:Name="downArrow"
        Height="29"
        Margin="50,1,1,1"
        Background="{x:Null}"
        Click="downArrow_Click">
        <Button.Template>
          <ControlTemplate TargetType="{x:Type Button}">
            <Grid Background="{DynamicResource WhiteBrush}">
              <Path
                x:Name="btnHistorymnu"
                Width="7"
                Height="5"
                Margin="5,0,0,0"
                HorizontalAlignment="Left"
                Data="M0,3 L7,3 3.5,7 z"
                Fill="{DynamicResource GrayBrush2}"
                RenderTransformOrigin=".5,.5"
                Stretch="Fill" />
            </Grid>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="btnHistorymnu" Property="Fill" Value="{DynamicResource GrayBrush3}" />
              </Trigger>
              <Trigger Property="IsMouseOver" Value="False">
                <Setter TargetName="btnHistorymnu" Property="Fill" Value="{DynamicResource GrayBrush2}" />
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter TargetName="btnHistorymnu" Property="Fill" Value="{DynamicResource GrayBrush3}" />
              </Trigger>
              <Trigger Property="IsEnabled" Value="False">
                <Setter TargetName="btnHistorymnu" Property="Opacity" Value="0.5" />
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Button.Template>
      </Button>
    </Grid>
    <Grid
      x:Name="NavControlsGrid"
      Grid.Row="1"
      Grid.ColumnSpan="2"
      Height="24"
      Margin="118,6,5,0"
      VerticalAlignment="Top">
      <Grid.ColumnDefinitions>
        <ColumnDefinition
          x:Name="breadcrumbBarColumn"
          Width="484*"
          MinWidth="200" />
        <ColumnDefinition
          x:Name="SearchBarColumn"
          Width="219"
          MinWidth="150" />
      </Grid.ColumnDefinitions>
      <odc:BreadcrumbBar
        x:Name="bcbc"
        BreadcrumbItemDropDownClosed="bcbc_BreadcrumbItemDropDownClosed"
        BreadcrumbItemDropDownOpened="bcbc_BreadcrumbItemDropDownOpened"
        Focusable="True"
        ImageBinding="{Binding Thumbnail.SmallBitmapSource}"
        OnEditModeToggle="bcbc_OnEditModeToggle"
        OnNavigate="OnBreadcrumbbarNavigate"
        TraceBinding="{Binding DisplayName}">
        <odc:BreadcrumbBar.Buttons>
          <Button x:Name="btnGoNavigation" Click="btnRefresh_Click">
            <Image Source="Images\Refresh16.png" Stretch="None" />
          </Button>
          <Button
            x:Name="btnCancelNavigation"
            Click="btnCancel_Click"
            Visibility="Collapsed">
            <Image Source="Images\cancel.png" Stretch="None" />
          </Button>
        </odc:BreadcrumbBar.Buttons>
        <odc:BreadcrumbBar.DropDownItems />
      </odc:BreadcrumbBar>

      <!--  my:SearchTextBox Margin="8,0,0,0" Name="searchTextBox1" HorizontalAlignment="Stretch" BorderBrush="Black" MinHeight="23" Search="searchTextBox1_Search" VerticalAlignment="Stretch" Grid.Column="1" PreviewMouseUp="searchTextBox1_PreviewMouseUp" MouseDown="searchTextBox1_MouseDown" GotFocus="searchTextBox1_GotFocus" IsKeyboardFocusedChanged="searchTextBox1_IsKeyboardFocusedChanged" LostFocus="searchTextBox1_LostFocus" LostKeyboardFocus="searchTextBox1_LostKeyboardFocus" GotKeyboardFocus="searchTextBox1_GotKeyboardFocus" MouseMove="searchTextBox1_MouseMove" MouseUp="searchTextBox1_MouseUp" /  -->
      <controls:SearchBox
        x:Name="edtSearchBox"
        Grid.Column="1"
        Margin="8,0,0,0"
        BeginSearch="edtSearchBox_BeginSearch"
        FiltersCleared="edtSearchBox_FiltersCleared"
        GotKeyboardFocus="edtSearchBox_GotKeyboardFocus"
        RequestCriteriaChange="edtSearchBox_RequestCriteriaChange" />
      <GridSplitter
        x:Name="gridSplitter1"
        Grid.Column="1"
        Width="8"
        HorizontalAlignment="Left"
        Background="#01000000"
        DragCompleted="gridSplitter1_DragCompleted"
        ResizeDirection="Columns">
        <GridSplitter.ContextMenu>
          <ContextMenu>
            <MenuItem
              x:Name="SearchBarReset"
              Click="SearchBarReset_Click"
              Header="{DynamicResource SearchBarResetCP}" />
          </ContextMenu>
        </GridSplitter.ContextMenu>
      </GridSplitter>
    </Grid>
    <controls:AirspacePopup
      x:Name="KeyJumpGrid"
      Width="{Binding ElementName=ShellViewHost, Path=ActualWidth}"
      Height="{Binding ElementName=ShellViewHost, Path=ActualHeight}"
      Margin="312,0,211.761,0"
      AllowOutsideScreenPlacement="True"
      AllowsTransparency="True"
      FollowPlacementTarget="True"
      IsOpen="False"
      ParentWindow="{Binding RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
      Placement="Center"
      PlacementTarget="{Binding ElementName=ShellViewHost}">
      <Grid
        Grid.Row="1"
        HorizontalAlignment="Center"
        VerticalAlignment="Center"
        Background="Transparent">
        <Border
          Width="Auto"
          Height="Auto"
          HorizontalAlignment="Center"
          VerticalAlignment="Center"
          Background="White"
          BorderBrush="Black"
          BorderThickness="2"
          CornerRadius="5"
          Opacity="0.5">
          <TextBlock
            x:Name="txtKeyJump"
            Margin="3,1,3,1"
            FontSize="20"
            Foreground="Black"
            Text="" />
        </Border>
      </Grid>
    </controls:AirspacePopup>
    <controls:AirspacePopup
      x:Name="Editor"
      AllowOutsideScreenPlacement="True"
      AllowsTransparency="True"
      FollowPlacementTarget="True"
      IsOpen="False"
      ParentWindow="{Binding RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
      Placement="AbsolutePoint"
      PlacementTarget="{Binding ElementName=ShellViewHost}"
      PopupAnimation="None">
      <Grid
        Grid.Row="1"
        HorizontalAlignment="Stretch"
        VerticalAlignment="Top"
        Background="Transparent">
        <TextBox
          x:Name="txtEditor"
          HorizontalAlignment="Center"
          VerticalAlignment="Top"
          AllowDrop="False"
          FocusManager.IsFocusScope="True"
          IsTabStop="False"
          Style="{StaticResource TextBoxStyle1}"
          TextAlignment="Center"
          TextWrapping="Wrap" />
      </Grid>
    </controls:AirspacePopup>
    <Rectangle
      x:Name="divNav"
      Grid.Row="2"
      Grid.ColumnSpan="2"
      Height="1"
      Fill="Gray" />
    <tabcontrol:TabControl
      x:Name="tcMain"
      Grid.Row="3"
      Grid.ColumnSpan="2"
      Height="25"
      Panel.ZIndex="99"
      SelectionChanged="tcMain_SelectionChanged"
      TabItemMaxHeight="25"
      TabItemMaxWidth="300"
      TabItemMinHeight="20"
      TabItemMinWidth="100" />
    <Grid
      Grid.Row="4"
      Grid.ColumnSpan="2"
      Background="{DynamicResource WhiteBrush}"
      Margin="1,0,1,0">
      <Grid.ColumnDefinitions>
        <ColumnDefinition />
        <ColumnDefinition x:Name="clPreviewSplitter" Width="2" />
        <ColumnDefinition x:Name="clPreview" Width="0" />
      </Grid.ColumnDefinitions>
      <Grid.RowDefinitions>
        <RowDefinition x:Name="rPreviewPane" Height="0" />
        <RowDefinition x:Name="rPreviewPaneSplitter" Height="1" />
        <RowDefinition />
      </Grid.RowDefinitions>
      <controls:DetailsPane
        x:Name="DetailsPanel"
        Grid.Row="0"
        Grid.ColumnSpan="3"
        Width="{Binding ActualWidth, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Grid}}}"
        Height="{Binding ActualHeight, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type RowDefinition}}}"
        Margin="0" />
      <GridSplitter
        Grid.Row="1"
        Grid.ColumnSpan="3"
        Height="1"
        HorizontalAlignment="Stretch"
        VerticalAlignment="Center"
        Background="LightBlue" />
      <Grid
        x:Name="TreeGrid"
        Grid.Row="2"
        Grid.Column="0"
        Background="{DynamicResource WhiteBrush}">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="200" />
          <ColumnDefinition Width="2" />
          <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <shell:ShellTreeView x:Name="stvTreeView"></shell:ShellTreeView>
        <GridSplitter
          x:Name="TreeSplitter"
          Grid.Column="1"
          Width="2"
          HorizontalAlignment="Center"
          VerticalAlignment="Stretch"
          Background="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabControl.Content.Background}" />
        <Grid Grid.Column="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="0"/>
          </Grid.ColumnDefinitions>
          <Helper:NoFlickerWindowsFormsHost
            x:Name="ShellViewHost"
            Background="{DynamicResource WhiteBrush}" />
          <ScrollBar x:Name="sbLVVertical" Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Minimum="0" Maximum="100" SmallChange="0.5" LargeChange="1" Scroll="ScrollBar_OnScroll"></ScrollBar>
        </Grid>
      </Grid>
      <GridSplitter
        Grid.Row="2"
        Grid.Column="1"
        Width="1"
        HorizontalAlignment="Center"
        VerticalAlignment="Stretch"
        Background="LightBlue" />
      <Previewer:PreviewerControl
        x:Name="Previewer"
        Grid.Row="2"
        Grid.Column="2"
        HorizontalAlignment="Stretch"
        VerticalAlignment="Stretch">
        <Previewer:PreviewerControl.Background>
          <SolidColorBrush Color="{DynamicResource {x:Static SystemColors.WindowBrush}}" />
        </Previewer:PreviewerControl.Background>
      </Previewer:PreviewerControl>
    </Grid>
    <GridSplitter
      Grid.Row="5"
      Grid.ColumnSpan="2"
      Height="2"
      HorizontalAlignment="Stretch" />
    <Grid
      Grid.Row="6"
      Grid.ColumnSpan="2"
      HorizontalAlignment="Stretch"
      Background="White">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
      </Grid.RowDefinitions>
      <ToolBar
        Grid.Row="0"
        SizeChanged="ToolBar_SizeChanged"
        ToolBarTray.IsLocked="True">
        <Ribbon:ToggleButton
          GroupName="CMDP"
          Header="CMD"
          Icon="Images\cmd16.png"
          IsChecked="True"
          SizeDefinition="Middle" />
        <Ribbon:ToggleButton
          Click="btnStartPowerShellClick"
          GroupName="CMDP"
          Header="PowerShell"
          Icon="Images\powershell16.png"
          IsEnabled="false"
          SizeDefinition="Middle" />
        <Separator />
        <Ribbon:SplitButton
          x:Name="btnConsoleHistory"
          Header="History"
          Icon="Images\history16.png"
          SizeDefinition="Middle" />
        <Ribbon:Button
          Click="ConsoleClear_Click"
          Header="Clear"
          Icon="Images\clear16.png"
          SizeDefinition="Middle" />
        <Separator />
        <Ribbon:ToggleButton
          Header="Sync"
          Icon="Images\Sync16.png"
          IsEnabled="False"
          SizeDefinition="Middle" />
      </ToolBar>
      <!--<consoleWPF:ConsoleControl x:Name="ctrlConsole" VerticalAlignment="Stretch" Grid.Row="1">

      </consoleWPF:ConsoleControl>-->
      <Helper:NoFlickerWindowsFormsHost
        x:Name="ctrlConsoleHost"
        Grid.Row="1"
        Grid.ColumnSpan="2"
        VerticalAlignment="Stretch"
        Background="Black">
        <console:ConsoleControl
          x:Name="ctrlConsole"
          BackColor="Black"
          OnConsoleInput="ctrlConsole_OnConsoleInput" />

        <!--
          SendKeyboardCommandsToProcess="True"
          OnConsoleInput="ctrlConsole_OnConsoleInput"
        -->

      </Helper:NoFlickerWindowsFormsHost>
    </Grid>
    <Ribbon:StatusBar
      x:Name="TheStatusBar"
      Grid.Row="8"
      Grid.ColumnSpan="2"
      Margin="0,0,0,-2">
      <Ribbon:StatusBarItem
        x:Name="sbiItemsCount"
        Title="Items Count"
        HorizontalAlignment="Left"
        Content="0 items"
        Foreground="{DynamicResource BackstageFontBrush}" />
      <Separator HorizontalAlignment="Left" />
      <Ribbon:StatusBarItem
        x:Name="sbiSelItemsCount"
        Title="{DynamicResource sbiSelItemsCount_Title}"
        HorizontalAlignment="Left"
        Content="0 selected items"
        Foreground="{DynamicResource BackstageFontBrush}" />
      <Separator
        x:Name="spSelItems"
        HorizontalAlignment="Left"
        Visibility="{Binding Path=Visibility, ElementName=sbiSelItemsCount}" />
      <Ribbon:StatusBarItem
        Title="Size Chart"
        HorizontalAlignment="Right"
        VerticalAlignment="Stretch"
        HorizontalContentAlignment="Right"
        VerticalContentAlignment="Stretch">
        <StackPanel VerticalAlignment="Stretch" Orientation="Horizontal">
          <Separator
            x:Name="spSelItems3"
            HorizontalAlignment="Left"
            Visibility="Visible" />
          <Ribbon:Button
            x:Name="btnSizeChart"
            Width="22"
            Height="18"
            HorizontalAlignment="Left"
            VerticalContentAlignment="Top"
            Click="btnSizeChart_Click"
            Icon="Images\jssize16.png"
            SizeDefinition="Small,Small,Small" />
        </StackPanel>
      </Ribbon:StatusBarItem>
      <Separator x:Name="spSelItems2" HorizontalAlignment="Right" />
      <Ribbon:StatusBarItem
        x:Name="sbiView"
        Title="View Style"
        HorizontalAlignment="Right"
        VerticalAlignment="Top"
        HorizontalContentAlignment="Right">
        <StackPanel Orientation="Horizontal">
          <Ribbon:ToggleButton
            x:Name="btnSbIcons"
            Width="18"
            Height="18"
            Click="StatusBar_Folder_Buttons"
            Icon="Images\medium16.png"
            SizeDefinition="Small,Small,Small" />
          <Ribbon:ToggleButton
            x:Name="btnSbDetails"
            Width="18"
            Height="18"
            Click="StatusBar_Folder_Buttons"
            Icon="Images\details16.png"
            SizeDefinition="Small,Small,Small" />
          <Ribbon:ToggleButton
            x:Name="btnSbTiles"
            Width="18"
            Height="18"
            Click="StatusBar_Folder_Buttons"
            Icon="Images\tiles16.png"
            SizeDefinition="Small,Small,Small" />
        </StackPanel>
      </Ribbon:StatusBarItem>
      <Separator x:Name="spSelItems4" HorizontalAlignment="Right" />
      <Ribbon:StatusBarItem Title="Zoom" HorizontalAlignment="Right">
        <StackPanel Height="18" Orientation="Horizontal">
          <TextBlock
            VerticalAlignment="Center"
            Foreground="{DynamicResource BackstageFontBrush}"
            Text="{Binding Value, ElementName=zoomSlider, StringFormat=\{0:0\}}" />
          <Slider
            x:Name="zoomSlider"
            Margin="3,0,0,0"
            IsDirectionReversed="False"
            Maximum="256"
            Minimum="48"
            Style="{DynamicResource ZoomSliderStyle}"
            ValueChanged="zoomSlider_ValueChanged"
            Value="16" />
        </StackPanel>
      </Ribbon:StatusBarItem>
    </Ribbon:StatusBar>
    <Button
      x:Name="btnTest"
      Grid.ColumnSpan="2"
      Width="75"
      Margin="673,23,0,0"
      VerticalAlignment="Top"
      Click="btnTest_Click"
      Content="Button"
      Visibility="Collapsed" />
  </Grid>
</Ribbon:RibbonWindow>